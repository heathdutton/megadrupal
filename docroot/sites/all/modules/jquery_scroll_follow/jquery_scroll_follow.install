<?php
/**
 * @file
 * Install, update and uninstall functions for
 * the jquery_scroll_follow module.
 */

/**
 * Implements hook_uninstall().
 */
function jquery_scroll_follow_uninstall() {
  variable_del('jquery_scroll_follow_css_target');
  variable_del('jquery_scroll_follow_settings_speed');
  variable_del('jquery_scroll_follow_settings_offset');
  variable_del('jquery_scroll_follow_settings_delay');
  variable_del('jquery_scroll_follow_location');
}

/**
 * Implements hook_requirements().
 */
function jquery_scroll_follow_requirements($phase) {
  $requirements = array();
  $t = get_t();

  switch ($phase) {
    case 'runtime':
      $jquery_scroll_follow_path = JQUERY_SCROLL_FOLLOW_DEFAULT_PATH;
      $path = variable_get('jquery_scroll_follow_location', $jquery_scroll_follow_path);
      if (!file_exists("$path/jquery.scrollfollow.js")) {
        $requirements['jquery_scroll_follow'] = array(
          'title' => $t('jQuery Scroll Follow'),
          'description' => $t('In order for the jQuery Scroll Follow module
        to work properly, the jQuery plugin should be downloaded and its location set.
        It is recommended to put the third party plugin in
        sites/all/libraries/jquery_scroll_follow but the location can be
        changed in the !settings. Currently looking
        for jQuery Scroll Follow in %path',
        array(
          '!settings' => l($t('settings'), 'admin/config/user-interface/jquery_scroll_follow'), '%path' => $path)),
          'severity' => REQUIREMENT_ERROR,
          'value' => $t('Third party jQuery Scroll Follow plugin missing'),
        );
      }
      else {
        $requirements['jquery_scroll_follow'] = array(
          'title' => $t('jQuery Scroll Follow'),
          'severity' => REQUIREMENT_OK,
          'value' => $t('Plugin jQuery Scroll Follow found'),
        );
      }
  }
  return $requirements;
}
