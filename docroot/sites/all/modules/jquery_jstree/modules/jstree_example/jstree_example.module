<?php

/**
 * @file
 * jsTree examples.
 */

/**
 * Implements hook_menu().
 */
function jstree_example_menu() {
  $items['jstree/a'] = array(
    'title' => 'jsTree A',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('jstree_example_a'),
    'access arguments' => array('access content'),
    'file' => 'jstree_example.pages.inc',
  );
  $items['jstree/a/data'] = array(
    'page callback' => 'jstree_example_example_data',
    'access arguments' => array('access content'),
    'type' => MENU_CALLBACK,
  );
  return $items;
}

/**
 * Ajax callback to return tree data
 */
function jstree_example_example_data() {
  $query = drupal_get_query_parameters();
  $parent = '0';
  if ($query['id'] != '#') {
    $parent = $query['id'];
  }
  $options = array();
  // Generate random elements.
  for ($i = 0; $i < rand(5, 10); $i++) {
    $options[] = array(
      'id' => check_plain($parent) . ':' . $i,
      'text' => 'Node ' . $i,
      'children' => rand(0, 1) ? TRUE : FALSE,
    );
  }

  drupal_json_output($options);
}
