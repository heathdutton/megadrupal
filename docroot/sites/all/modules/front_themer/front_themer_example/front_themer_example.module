<?php
/**
 * @file
 * Main file for front_themer_example module. Provides an example of the usage of front_themer module.
 *
 */

/**
 * Implements hook_theme().
 */
function front_themer_example_theme($existing, $type, $theme, $path) {
  $theme = array(
    'front_themer_example' => array(
      'variables' => array(
        'class' => 'myClass',
        'title' => 'My Title',
        'content' => 'My Content',
        'mode' => 'visible'
      )
    )
  );

  return $theme;
}

/**
 * Implements hook_front_themer_theme().
 */
function front_themer_example_front_themer_theme() {
  $theme = array();

  //See theme_front_themer_example() for variables and theme implementation

  //Create a JS implementation named example_visible of theme front_theme_example
  $theme['example_visible'] = array(
    'theme' => 'front_themer_example',
    'arguments' => array(
      'class' => array(
        'type' => 'placeholder', //Indicates that we want to populate the actual value for this variable in JS
        'variable_name' => 'className' //Rename the variable because using 'class' in JS is a bad idea
      ),
      'title' => array(
        'type' => 'placeholder',
        'sanitize' => TRUE, //Indicates that whatever we input as value of this variable in JS should be passed to Drupal.checkPlain()
      ),
      'content' => array(
        'type' => 'placeholder',
        'sanitize' => TRUE,
      ),
      'mode' => array(
        'type' => 'value', //Simply a value to be passed to Drupal's theme() when generating the output for the JS implementation
        'value' => 'visible'
      )
    )
  );

  //Create another JS implementation of the same theme, but with different mode
  //(This is how you deal with login in your Drupal theme: create a separate JS implementation for each branch)
  $theme['example_hidden'] = array(
    'theme' => 'front_themer_example',
    'arguments' => array(
      'class' => array(
        'type' => 'placeholder',
        'variable_name' => 'className'
      ),
      'title' => array(
        'type' => 'placeholder',
        'sanitize' => TRUE
      ),
      'content' => array(
        'type' => 'placeholder',
        'sanitize' => TRUE
      ),
      'mode' => array(
        'type' => 'value',
        'value' => 'hidden' //The only difference to the previous example is here
      )
    )
  );

  //Yet another JS implementation of the same theme. Use whatever default values the theme uses.
  $theme['example_defaults'] = array(
    'theme' => 'front_themer_example'
  );

  return $theme;
}

/**
 * Implements hook_init().
 */
function front_themer_example_init() {
  drupal_add_js(drupal_get_path('module', 'front_themer_example') . '/front_themer_example.js');
}

/**
 * Default implementation of theme 'front_themer_example'.
 */
function theme_front_themer_example($variables) {
  $class = $variables['class'];
  $title = $variables['title'];
  $content = $variables['content'];
  $mode = $variables['mode'];

  $style = ($mode == 'visible') ? '' : ' style="display:none;"';

  return "<div$style class=\"$class\"><h2>$title</h2><p>$content</p></div>";
}