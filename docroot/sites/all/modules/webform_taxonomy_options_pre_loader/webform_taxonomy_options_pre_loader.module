<?php
/**
 * @file
 * Simple module to provide facility to use taxonomy as webform prebuilt list.
 */

/**
 * Implements hook_webform_select_options_info().
 */
function webform_taxonomy_options_pre_loader_webform_select_options_info() {
  $items = array();
  $vocabularies = taxonomy_get_vocabularies();
  foreach ($vocabularies as $seperatevocab) {
    $items['vid_' . $seperatevocab->vid] = array(
      'title' => $seperatevocab->name,
      'options callback' => 'webform_taxonomy_options_pre_loader_terms',
      'options arguments' => $seperatevocab->vid,
    );
  }
  return $items;
}

/**
 * Option list containing all terms of specified vocabulary.
 */
function webform_taxonomy_options_pre_loader_terms($component, $flat, $vid) {
  $terms = array();
  $allterms = taxonomy_get_tree($vid);
  foreach ($allterms as $term) {
    if (module_exists('i18n_taxonomy')) {
      $term = i18n_taxonomy_localize_terms($term);
      $terms['tid_' . $term->tid] = $term->name;
    }
    else {
      $terms['tid_' . $term->tid] = $term->name;
    }
  }
  return $terms;
}
