<?php
function menu_content_type_assign_form_menu_edit_menu_alter(&$form, &$form_state, $form_id){
  $currentMenu = $form['old_name']['#value'];
  $multiple = TRUE;
  $options = array();
  $contentTypes = node_type_get_types();
  $defaults = array();
  foreach($contentTypes as $machineName => $type){
    $options[$machineName] = $type->name;
    $menu_settings = variable_get('menu_options_' . $machineName);
    if(is_array($menu_settings) && !empty($menu_settings) && in_array($currentMenu, $menu_settings)){
      $defaults[] = $machineName;
    }
  }
  $form['menu_content_type_assign'] = array(
    '#type' => 'select',
    '#title' => 'Content type(s) to allow access to menu',
    '#options' => $options,
    '#default_value' => $defaults,
    '#description' => 'Choose the node type(s) that you want to have the ability to add links to this menu via the node edit form.',
    '#multiple' => $multiple,
    '#size' => $multiple ? min(6, count($options)) : 0
  );
  $form['#submit'][] = 'menu_content_type_assign_menu_edit_menu_submit';
}

function menu_content_type_assign_menu_edit_menu_submit(&$form, &$form_state){
  $chosenTypes = $form_state['values']['menu_content_type_assign'];
  $types = node_type_get_types();
  $currentMenu = $form_state['values']['menu_name'];
  foreach($types as $typeMachineName => $type){
    $menu_options = variable_get('menu_options_' . $typeMachineName);
    if(in_array($currentMenu, $menu_options) && !in_array($typeMachineName, $chosenTypes)){
      $itemIndex = array_search($currentMenu, $menu_options);
      unset($menu_options[$itemIndex]);
      variable_set('menu_options_' . $typeMachineName, $menu_options);
    } elseif(!in_array($currentMenu, $menu_options) && in_array($typeMachineName, $chosenTypes)){
      $menu_options[] = $currentMenu;
      variable_set('menu_options_' . $typeMachineName, $menu_options);
    }
  }
}