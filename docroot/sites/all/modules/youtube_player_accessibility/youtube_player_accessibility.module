<?php
/**
 * Implements hook_menu().
 */
function youtube_player_accessibility_menu() {
  $items = array();

  $items['admin/config/media/youtube-player-accessibility'] = array(
    'title' => 'Youtube player accessibility',
    'description' => 'Youtube player accessibility configration page.',
    'page callback' => 'youtube_player_accessibility_page',
    'access arguments' => array(' administer youtube player accessibility'),
    'type' => MENU_NORMAL_ITEM,
    'file' => 'youtube_player_accessibility.admin.inc',
    'file path' => drupal_get_path('module', 'youtube_player_accessibility') . '/include',
  );

  return $items;
}

/**
 * Implements hook_permission()
 */
function youtube_player_accessibility_permission() {
  return array(
    'administer youtube player accessibility' => array(
      'title' => t('Administer youtube player accessibility'),
      'description' => t('Configure youtube player accessibility module.'),
    ),
  );
}

/**
 * Implements hook_init().
 */
function youtube_player_accessibility_init() {

  // add support for HTML controls on YouTube videos. See http://wac.osu.edu/examples/youtube-player-controls/

  if ($path = libraries_get_path('ytp')) {
    if (file_exists($path . '/js/ytp.js')) {

      drupal_add_js('http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js', array('type' => 'external', 'group' => 'JS_LIBRARY'));

      drupal_add_js($path . '/js/ytp.js');
      drupal_add_css($path . '/css/ytp.css');

      drupal_add_js(drupal_get_path('module', 'youtube_player_accessibility').'/js/youtube_player_accessibility_custom.js');

      $js_setting = array(
        'YoutubePA' => array(
          'requirementsTxt' => variable_get('requirements_txt', t("You need Flash player 8+ and JavaScript enabled to view this video.")),
          'headerTxt' => variable_get('header_txt', t("Player Controls")),
          'playTxt' => variable_get('play_txt', t("Play")),
          'forwardTxt' => variable_get('forward_txt', t("Forward 20%")),
          'backTxt' => variable_get('back_txt', t("Back 20%")),
          'stopTxt' => variable_get('stop_txt', t("Stop")),
          'volUpTxt' => variable_get('vol_up_txt', t("Volume Up")),
          'volDnTxt' => variable_get('vol_dn_txt', t("Volume Down")),
          'muteTxt' => variable_get('mute_txt', t("Mute")),
          'loopTxt' => variable_get('loop_txt', t("Loop")),
          'currentlyPlayingTxt' => variable_get('currently_playing_txt', t("Currently Playing:")),
          'timeTxt' => variable_get('time_txt', t("Time:")),
          'unmuteTxt' => variable_get('unmute_txt', t("Unmute")),
          'pauseTxt' => variable_get('pause_txt', t("Pause")),
          'unloopTxt' => variable_get('unloop_txt', t("UnLoop")),
          'videoPlayListTxt' => variable_get('video_play_list_txt', t("Video Play List")),
          'ofTxt' => variable_get('of_txt', t("of")),
        ),
      );

      drupal_add_js($js_setting, 'setting');
    }
  }
  else {
    drupal_set_message(t('Please Make sure that you have ytp library istalled.'), 'warning');
  }
}

/**
 * Implements hook_theme_registery_alter().
 */
function youtube_player_accessibility_theme_registry_alter(&$theme_registry) {
  $path = drupal_get_path('module', 'youtube_player_accessibility') . "/youtube_player/video-embed-field-embed-code";
  $theme_registry['video_embed_field_embed_code']['template'] = $path;
}