<?php

/**
 * @file
 * Defines a field type for displaying a duplicate set of submit buttons on the node/edit form.
 */

/**
 * Implementation of hook_field_info().
 */
function submit_field_field_info() {
  return array(
    'submit_field' => array(
      'label' => 'Submit Field',
      'description' => t("Provides field to output submit buttons on the entitys edit form"),
      'default_widget' => 'submit_field',
      'default_formatter' => 'submit_field_default',
    ),
  );
}

/**
 * Implementation of hook_field_settings_form().
 */
function submit_field_field_settings_form($field, $instance, $has_data) {
  $form = array();
  $settings = $field['settings'];
  // Need this because the form will throw errors unless a form element is
  // created.
  $form['submit_field'] = array(
    '#type' => 'hidden',
    '#default_value' => isset($settings['submit_field']) ? $settings['submit_field'] : '',
  );
  return $form;
}

/**
 * Implementation of hook_field_widget_info().
 */
function submit_field_field_widget_info() {
  return array(
    'submit_field' => array(
      'label' => 'Submit Field',
      'field types' => array('submit_field'),
      'behaviors' => array(
        'multiple values' => FIELD_BEHAVIOR_DEFAULT,
        'default value' => FIELD_BEHAVIOR_NONE,
      ),
    ),
  );
}

/**
 * Implementation of hook_field_widget_form().
 */
function submit_field_field_widget_form(&$form, &$form_state, $field, $instance, $langcode, $items, $delta, $element) {
  $element += array(
    'submit_field' => array(
      '#markup' => '<div class="submit-field-buttons"></div>',
      '#attached'  => array(
        'js' => array(
          drupal_get_path('module', 'submit_field') . '/submit_field.js',
        ),
      ),
    ),
  );
  return $element;
}

// Remove 'number of values' selection
function submit_field_form_alter(&$form, &$form_state, $form_id) {
  if ($form_id == 'field_ui_field_edit_form'){
    if ($form['#field']['module'] == 'submit_field'){
      unset($form['field']['cardinality']);  
    }
  }
}

