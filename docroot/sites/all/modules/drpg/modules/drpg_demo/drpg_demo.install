<?php

/**
 * @file
 * Defines demonstration entities for use with the DRPG module.
 */

/**
 * Implements hook_install().
 */
function drpg_demo_install() {
  drpg_demo_create_item_content();
  drpg_demo_create_item_container_content();
  drpg_demo_create_avatar_content();
  drpg_demo_create_npc_content();
  drpg_demo_create_room_content();
}

/**
 * Creates demo item entities.
 */
function drpg_demo_create_item_content() {
  $item_values = array(
    array(
      'label' => 'Wooden Sword of Mild Discomfort',
      'rarity' => 1,
    ),
    array(
      'label' => 'Wooden Bow',
      'rarity' => 3,
    ),
    array(
      'label' => 'Iron Sword',
      'rarity' => 4,
    ),
    array(
      'label' => 'Steel Sword',
      'rarity' => 8,
    ),
    array(
      'label' => 'Staff of Fire',
      'rarity' => 10,
    ),
  );

  foreach ($item_values as $values) {
    $entity = entity_create('drpg_item', $values);
    $entity->save();
  }
}

/**
 * Creates demo item container entities.
 */
function drpg_demo_create_item_container_content() {
  $item_values = array(
    array(
      'label' => 'Common Loot Chest',
      'item_quantity' => 2,
      'item_rarity' => 5,
      'item_rarity_operator' => '<=',
    ),
    array(
      'label' => 'Rare Loot Chest',
      'item_quantity' => 1,
      'item_rarity' => 5,
      'item_rarity_operator' => '>',
    ),
  );

  foreach ($item_values as $values) {
    $entity = entity_create('drpg_item_container', $values);
    $entity->save();
  }
}

/**
 * Creates a demo avatar entity.
 */
function drpg_demo_create_avatar_content() {
  $values = array(
    'owner_uid' => 1,
    'label' => 'Drupal Guy',
    'currency' => 100,
  );

  $entity = entity_create('drpg_avatar', $values);
  $entity->save();

  $attribute_values = array(
    'type' => 'drpg_avatar',
    'entity_id' => $entity->avatar_id,
    'attribute_name' => 'hp',
    'value' => 100,
  );

  $attribute_entity = entity_create('drpg_attribute', $attribute_values);
  $attribute_entity->save();

  $attribute_values['attribute_name'] = 'xp';
  $attribute_values['value'] = 50;

  $attribute_entity = entity_create('drpg_attribute', $attribute_values);
  $attribute_entity->save();
}

/**
 * Creates demo NPC entities.
 */
function drpg_demo_create_npc_content() {
  $item_values = array(
    array(
      'type' => 'friendly',
      'label' => 'Friendly NPC',
    ),
    array(
      'type' => 'enemy',
      'label' => 'Enemy NPC',
    ),
  );

  foreach ($item_values as $values) {
    $entity = entity_create('drpg_npc', $values);
    $entity->save();
  }
}

/**
 * Creates demo room entity.
 */
function drpg_demo_create_room_content() {
  $values = array(
    'label' => 'Main Room',
    'item_container_quantity' => 2,
  );

  $entity = entity_create('drpg_room', $values);
  $entity_wrapper = entity_metadata_wrapper('drpg_room', $entity);

  $item_containers = entity_load('drpg_item_container', array(1, 2));

  $entity_wrapper->drpg_multi_item_container_ref->set($item_containers);
  $entity_wrapper->save();
}
