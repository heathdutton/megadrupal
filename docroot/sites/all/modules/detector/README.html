<p>// $Id:$</p>

<h1 id="detector">Detector</h1>

<p>This Drupal module supports the inclusion of Dave Olsen&#8217;s Detector library in
Drupal, and allows Drupal to use the provided $ua variable to detect browser
capabilities.</p>

<p><a href="https://github.com/dmolsen/Detector">https://github.com/dmolsen/Detector</a><br/>
<a href="http://detector.dmolsen.com/">http://detector.dmolsen.com/</a></p>

<p>This module was developed by Geoffrey Roberts at
<a href="http://crossfunctional.net">Cross(Functional)</a>.</p>

<p><a href="&#x6d;&#97;&#x69;&#x6c;&#x74;&#x6f;&#58;&#103;&#x65;&#x6f;&#102;&#x66;&#114;&#x65;&#x79;&#64;&#99;&#114;&#111;&#115;&#x73;&#102;&#x75;&#x6e;&#99;&#116;&#105;&#x6f;&#x6e;&#x61;&#x6c;&#46;&#110;&#101;&#x74;">&#x67;&#x65;&#111;&#x66;&#102;&#x72;&#x65;&#x79;&#x40;&#99;&#x72;&#111;&#115;&#x73;&#102;&#x75;&#110;&#x63;&#116;&#105;&#x6f;&#110;&#97;&#108;&#x2e;&#x6e;&#x65;&#116;</a><br/>
<a href="&#x6d;&#97;&#x69;&#108;&#x74;&#x6f;&#x3a;&#103;&#x2e;&#114;&#x6f;&#98;&#x65;&#114;&#116;&#x73;&#64;&#x62;&#108;&#97;&#99;&#107;&#105;&#x63;&#x65;&#109;&#x65;&#100;&#105;&#97;&#46;&#x63;&#111;&#109;">&#103;&#46;&#x72;&#x6f;&#98;&#101;&#114;&#x74;&#x73;&#x40;&#98;&#x6c;&#97;&#99;&#107;&#x69;&#99;&#101;&#x6d;&#x65;&#x64;&#105;&#x61;&#46;&#x63;&#x6f;&#x6d;</a></p>

<h2 id="introduction">Introduction</h2>

<blockquote>
<p>Detector is a simple, PHP- and JavaScript-based browser- and
feature-detection library that can adapt to new devices &amp; browsers on its own
without the need to pull from a central database of browser information.</p>

<p>Detector dynamically creates profiles using a browser&#8217;s (mainly) unique
user-agent string as a key. Using Modernizr it records the HTML5 &amp; CSS3
features a requesting browser may or may not support. ua-parser-php is used
to collect and record any useful information (like OS or device name) the
user-agent string may contain.</p>

<p>With Detector a developer can serve the appropriate markup, stylesheets,
and JavaScript to a requesting browser without being completely dependent
on a front-end-only resource loader nor a browser-detection library being
up-to-date.</p>
</blockquote>

<ul>
<li><em><a href="https://github.com/dmolsen/Detector#readme">Detector README</a></em></li>
</ul>

<p>This Drupal module includes the Detector library, and sets it up to run tests
on the browser in such a way that custom Drupal modules are able to detect
browser capabilities.</p>

<p>For a demonstration of the sorts of browser capabilities that Detector
can detect, see the <a href="http://detector.dmolsen.com/">official Detector site</a>.</p>

<h2 id="installation">Installation</h2>

<p>See <a href="http://drupal.org/documentation/install/modules-themes">http://drupal.org/documentation/install/modules-themes</a>
for a general guide on installing and updating modules.</p>

<p>This module requires the <a href="http://drupal.org/project/libraries">Libraries</a>
module in order to work. It also requires that you install the Detector
library into your site&#8217;s Libraries directory.</p>

<p>For most sites, your Libraries directory will be<br/>
<code>sites/all/libraries</code></p>

<p>If you are using an installation profile, the Libraries directory will be<br/>
<code>profile/profile_name/libraries</code></p>

<h3 id="installingdetectorlibrary">Installing Detector library</h3>

<p>The easiest way to install the Detector libraries is by using Git.</p>

<p>To clone the Github repository into your site, go to your Libraries directory
and type:<br/>
<code>git clone https://github.com/dmolsen/Detector.git</code></p>

<p>On the other hand, if your site is already in Git and you&#8217;d like a bit more
control over dependent repositories, you may be better off adding it as a
submodule. To do that, run the following from the root directory:
<code>git submodule add https://github.com/dmolsen/Detector.git path/to/libraries/Detector
git add .gitmodules</code></p>

<p>More information about Git submodules can be found in the
<a href="http://git-scm.com/book/en/Git-Tools-Submodules">GIT SCM Manual.</a></p>

<p>Once you&#8217;ve finished copying the Detector library to its destination, follow
the <a href="https://github.com/dmolsen/Detector/wiki/Adding-&amp;-Using-Detector-With-Your-Application">installation procedure</a>. This includes
setting up its config.ini file and changing permissions on some subdirectories.</p>

<h3 id="extratests">Extra Tests</h3>

<p>This module provides a few additional, optional tests that detect Flash and
Java. See the <a href="#extras">Extras</a> section for more details.</p>

<h2 id="usage">Usage</h2>

<p>There are multiple ways to use Detector&#8217;s abilities.</p>

<h3 id="referencetoglobaluaobject">Reference to global $ua object</h3>

<p>Detector publishes a global variable called <strong>$ua</strong>, that contains the relevant
client details straight from the source</p>

<p><code>global $ua;</code></p>

<p>For more detailed information on the usage of the $ua object, see the
<a href="https://github.com/dmolsen/Detector#readme">Detector documentation</a>.</p>

<h3 id="detectorproperty">DetectorProperty</h3>

<p>There is also a class called DetectorProperty that exposes functions that will
help you obtain details from the $ua object without having to reference it
directly. It exposes a couple of static functions:</p>

<ul>
<li><strong>DetectorProperty::getProperty($id)</strong><br/>
 Fetches the contents of the property matching key $id. If the property you
 are looking for is nested, use an arrow to join them.<br/>
 For example, <strong>&#8220;screenattributes-&gt;colorDepth&#8221;</strong> will fetch the colour depth
 of the screen attached to the client.</li>
<li><strong>DetectorProperty::listProperties()</strong><br/>
 Fetches a list of all Detector properties in a key/value array.</li>
</ul>

<h3 id="rules">Rules</h3>

<p>Detector offers its properties up to Rules. You can also use &#8220;when Detector
properties are initialised&#8221; as a Rules action.</p>

<h3 id="context">Context</h3>

<p>Detector also offers up its properties to Context module, so that site contexts
can be set on the value of a particular property. To use it on a set of
properties, define multiple Contexts and combine them into another Context,
using a Context action.</p>

<h2 id="extras">Extras</h2>

<p>This module provides a few additional, optional tests that detect Flash and
Java. To use these tests, copy them from the <strong>tests/perrequest</strong> directory
into Detector&#8217;s <strong>lib/Detector/tests/perrequest</strong> directory.</p>

<h3 id="requirements">Requirements</h3>

<p>These tests require additional JavaScript to be included via CDN,
specifically:</p>

<ul>
<li>Java detection: <a href="http://java.com/js/deployJava.js">deployJava.js</a> from java.com</li>
<li>Flash detection: <a href="http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js">swfobject.js</a> from ajax.googleapis.com</li>
</ul>

<p>The module supports copies of these libraries at custom-defined sources, and
allows for them to be hosted anywhere you like, whether within your Drupal site
itself, or on a CDN you control.</p>

<p>Once you&#8217;ve installed these files where you want, go to the Settings page
(admin/config/development/detector) and set the URL (if an external file) or
the internal path (if local) into the
<strong>Path to deployJava script</strong> and <strong>Path to swfobject script</strong> fields.</p>

<h2 id="todo">TODO</h2>

<ul>
<li>If Modernizr module is installed, use its copy of Modernizr to prevent
 library overloading.</li>
</ul>
