<?php

/**
 * @file
 * The main module file for showmeyouremail module.
 */

/**
 * Implements hook_permission().
 */
function showmeyouremail_permission() {
  return array(
    'view user email addresses on user profiles' => array(
      'title' => t('View user email addresses on user profiles'),
      'description' => t('View user email addresses on user profiles.'),
    ),
  );
}

/**
 * Implements hook_user_view().
 */
function showmeyouremail_user_view($account, $view_mode, $langcode) {
  if (user_access('view user email addresses on user profiles')) {
    $account->content['showmeyouremail'] = array(
      '#theme' => 'showmeyouremail_user',
      '#mail'  => $account->mail,
      '#weight' => 0,
    );
  }
}

/**
 * Implements hook_theme().
 */
function showmeyouremail_theme() {
  return array(
    'showmeyouremail_user' => array(
      'variables' => array(
        'mail' => NULL,
      ),
    ),
  );
}

/**
 * Default theme output for showmeyouremail_user.
 */
function theme_showmeyouremail_user($variables) {
  $link = l($variables['mail'], 'mailto:' . $variables['mail']);
  $output = '<div class="email">';
  $output .= '<div class="field-label">Email: </div>';
  $output .= $link;
  $output .= '</div>';
  return $output;
}
