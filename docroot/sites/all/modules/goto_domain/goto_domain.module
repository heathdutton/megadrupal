<?php

/**
 * @file
 * Goto Domain Module
 */

/**
 * Implements hook_goto_alter().
 */
function goto_domain_drupal_goto_alter(&$path, &$options, &$http_response_code) {
  global $base_url;

  $domain_replace_rules = explode("\r\n", variable_get('goto_domain_mapping', ''));
  $domain_replace_rules_set = array();
  foreach ($domain_replace_rules as $domain_replace_rule_string) {
    $redirection_rule_item = explode("|", $domain_replace_rule_string);
    $domain_replace_rules_set[$redirection_rule_item[0]] = $redirection_rule_item[1];
  }

  if (in_array($base_url, array_keys($domain_replace_rules_set))) {
    $path = $domain_replace_rules_set[$base_url] . '/' . $path;
  }
}

/**
 * Implements hook_menu().
 */
function goto_domain_menu() {
  $items['admin/config/system/goto-domain'] = array(
    'title' => 'Goto Domain',
    'description' => 'Goto Domain Settings',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('goto_domain_settings'),
    'access arguments' => array('administer site configuration'),
    'file' => 'goto_domain.admin.inc',
  );
  return $items;
}
