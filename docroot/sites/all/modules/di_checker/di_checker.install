<?php

/**
 * @file
 * Data integrity checker install file.
 */

/**
 * Implements hook_requirements().
 */
function di_checker_requirements($phase) {
  $requirements = array();
  $t = get_t();

  $di_data = module_invoke_all('di_checker_info');

  if (count($di_data)) {
    $status = REQUIREMENT_WARNING;
    $message = $t('Some data integrity issues found on site. Please visit !link for details.', array('!link' => l($t('Data integrity report'), 'admin/reports/di')));
  }
  else {
    $status = REQUIREMENT_OK;
    $message = $t('No data integrity issues found.');
  }

  if ($phase == 'runtime') {
    $requirements['di_checker'] = array(
      'title' => $t('Data integrity checker'),
      'severity' => $status,
      'value' => $message,
    );
  }

  return $requirements;
}
