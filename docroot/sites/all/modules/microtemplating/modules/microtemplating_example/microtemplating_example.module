<?php
/**
 * @file
 * Main file for the microtemplating_example module.
 */

/**
 * Implements hook_menu().
 */
function microtemplating_example_menu() {
  $menu = array();

  $menu['todos'] = array(
    'title'            => 'Todo application page',
    'description'      => 'Microtemplating todo list example page.',
    'page callback'    => 'microtemplating_example_todos',
    'access arguments' => array('access content'),
  );

  return $menu;
}

/**
 * Implements hook_theme().
 */
function microtemplating_example_theme() {
  return array(
    'microtemplating_example_todos' => array(
      'template'  => 'templates/microtemplating_example_todos',
      'variables' => array(),
    ),
    'microtemplating_example_todo_js' => array(
      'template'  => 'templates/microtemplating_example_todo_js',
      'variables' => array(),
    ),
    'microtemplating_example_footer_js' => array(
      'template'  => 'templates/microtemplating_example_footer_js',
      'variables' => array(),
    ),
  );
}

/**
 * Page callback.
 */
function microtemplating_example_todos() {
  $module_path = drupal_get_path('module', 'microtemplating_example');

  return array(
    'content' => array(
      '#theme' => 'microtemplating_example_todos',
    ),
    'todo_js' => array(
      '#theme_wrappers' => array('js_template'),
      '#theme'          => 'microtemplating_example_todo_js',
      '#id'             => 'js__microtemplating_example__todo',
    ),
    'footer_js' => array(
      '#theme_wrappers' => array('js_template'),
      '#theme'          => 'microtemplating_example_footer_js',
      '#id'             => 'js__microtemplating_example__footer',
    ),
    '#attached' => array(
      'library' => array(
        array('microtemplating', 'microtemplating'),
      ),
      'js' => array(
        $module_path . '/js/todoapp.js',
        $module_path . '/js/microtemplating_example.js',
      ),
      'css' => array(
        $module_path . '/css/todoapp.css',
      ),
    ),
  );
}
