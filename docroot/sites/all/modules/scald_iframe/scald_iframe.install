<?php

/**
 * @file
 * Scald Iframe Installation
 */

/**
 * Implements hook_install().
 */
function scald_iframe_install() {
  ScaldAtomController::addType('iframe', 'Iframe', 'Iframe');
}

/**
 * Implements hook_enable().
 */
function scald_iframe_enable() {
  field_cache_clear();
  field_associate_fields('scald_url');

  // Check if our field is not already created.
  if (!field_info_field('scald_url')) {
    $field = array(
      'field_name' => 'scald_url',
      'type' => 'text',
      'label' => t('URL'),
    );
    field_create_field($field);

    // Create the instance on the bundle.
    $instance = array(
      'field_name' => 'scald_url',
      'entity_type' => 'scald_atom',
      'label' => t('IFrame URL'),
      'bundle' => 'iframe',
      'required' => TRUE,
      'widget' => array(
        'settings' => array(
          'size' => '128',
        ),
        'type' => 'text_textfield',
        'weight' => '0',
      ),
    );

    field_create_instance($instance);
  }
}

/**
 * Install url field.
 */
function scald_iframe_update_7001() {
  scald_iframe_enable();
}

/**
 * Implements hook_uninstall().
 */
function scald_iframe_uninstall() {
  drupal_load('module', 'scald');
  // If Scald is disabled, its classes are not autoloaded.
  module_load_include('inc', 'scald', 'includes/ScaldAtomController');

  ScaldAtomController::removeType('iframe');
}