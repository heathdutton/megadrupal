<?php
/**
 * @file
 */

/*
 * This program is free software; you can redistribute it and/or modify 
 * it under the terms of the GNU General Public License as published by 
 * the Free Software Foundation; version 2 of the License.
 *
 * This program is distributed in the hope that it will be useful, 
 * but WITHOUT ANY WARRANTY; without even the implied warranty of 
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 * GNU General Public License for more details. 
 *
 * You should have received a copy of the GNU General Public License 
 * along with this program; if not, write to the Free Software 
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * @author Victor Shnayder (shnayder seas.harvard.edu)
 * @author Dan Margo (dmargo eecs.harvard.edu)
 */

/**
 * Implements hook_schema().
 */
function mayl_schema() {
  $schema['mayl_mirrors'] = array(
    'description' => 'MAYL Mirror Table',
    'fields' => array(
      // id
      'mid' => array(
        'description' => 'The unique MAYL mirror ID.',
        'type' => 'serial',
        'not null' => TRUE,
        'unsigned' => TRUE,
      ),
      // post_id
      'nid' => array(
        'description' => 'The {node}.nid of the post.',
        'type' => 'int',
        'not null' => TRUE,
        'unsigned' => TRUE,
         'default' => 0,
       ),
       'host_url' => array(
         'description' => 'The mirror host URL.',
         'type' => 'text',
         'not null' => TRUE,
       ),
       'mirror_size' => array(
         'description' => 'The mirror size.',
         'type' => 'int',
         'size' => 'big',
         'not null' => TRUE,
         'unsigned' => TRUE,
         'default' => 0,
        ),
       'created' => array(
         'description' => 'The time the mirror was created.',
         'type' => 'int',
         'not null' => FALSE,
         'default' => 0,
       ),
       'updated' => array(
         'description' => 'The time the mirror was updated.',
         'type' => 'int',
         'not null' => FALSE,
         'default' => 0,
       ),
      ),
      'primary key' => array('mid'),
      'indexes' => array(
        'nid' => array('nid'),
        'time' => array('created', 'updated'),
      ),
  );

  return $schema;
}

/**
 * Implements hook_uninstall().
 */
function mayl_uninstall() {
  variable_del('mayl_href_css_class');
  variable_del('mayl_mirror_css_class');
  variable_del('mayl_wget_path');
  variable_del('mayl_user_agent');
  variable_del('mayl_mirror_directory');
}

/*
	$wpdb->insert($wpdb->prefix . MIRROR_TABLE, array(
	                'post_id' => $post->ID,
	                'host_url' => $host_url,
	                'mirror_time' => current_time('mysql')));

	return $wpdb->insert_id;
}
*/
