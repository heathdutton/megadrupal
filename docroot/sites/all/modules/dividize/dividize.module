<?php

/**
 * @file
 * Module hook implementations.
 */

/**
 * Implements hook_init().
 */
function dividize_init() {
  if (!path_is_admin(current_path())) {
    dividize_add_js();
    dividize_add_settings();

    if (variable_get('dividize_css', TRUE)) {
      dividize_add_css();
    }
  }
}

/**
 * Implements hook_menu().
 */
function dividize_menu() {
  $items = array();

  $items['admin/config/user-interface/dividize'] = array(
    'title' => 'Dividize',
    'description' => 'Converting a table to a responsive DIV structure',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('dividize_admin_settings'),
    'access arguments' => array('administer site configuration'),
    'file' => 'dividize.admin.inc',
  );

  return $items;
}

/**
 * Include js files as necessary.
 */
function dividize_add_js() {
  drupal_add_js(drupal_get_path('module', 'dividize') . '/js/dividize.js');
}

/**
 * Include js settings as necessary.
 */
function dividize_add_settings() {
  static $global_settings_added = FALSE;

  if (!$global_settings_added) {
    $global_settings_added = TRUE;

    $settings = array(
      'dividize' => array(
        'selector' => variable_get('dividize_selector', 'table'),
        'width' => variable_get('dividize_width', 768),
        'classes' => variable_get('dividize_classes', 'dividize-processed'),
        'removeHeaders' => variable_get('dividize_remove_headers', FALSE),
        'addLabelHeaders' => variable_get('dividize_add_label_headers', TRUE),
        'hideLabels' => variable_get('dividize_hide_labels', TRUE),
        'preserveEvents' => variable_get('dividize_preserve_events', TRUE),
        'preserveDim' => variable_get('dividize_preserve_dim', TRUE),
        'enableAltRows' =>variable_get('dividize_enable_alt_rows', TRUE),
      ),
    );

    drupal_add_js($settings, 'setting');
  }
}

/**
 * Include css files as necessary.
 */
function dividize_add_css() {
  drupal_add_css(drupal_get_path('module', 'dividize') . '/css/dividize.css');
}
