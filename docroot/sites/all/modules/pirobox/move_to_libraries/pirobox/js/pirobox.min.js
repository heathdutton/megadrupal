/**
* Name: piroBox v.1.2.57;  Date: May 2010; Autor: Diego Valobra (http://www.pirolab.it),(http://www.diegovalobra.com); Version: 1.2.2
* Licence: CC-BY-SA http://creativecommons.org/licenses/by-sa/2.5/it/
* Modified: November 2011; Modification author: Siegfried Neumann aka Quiptime
**/
(function(a){a.fn.piroBox=function(b){b=jQuery.extend({my_speed:null,close_speed:300,bg_alpha:0.5,close_all:".piro_close,.piro_overlay",slideShow:null,slideSpeed:null,imgBlur:false,imgBlurRadius:2,blurTime:3000,current:"of",previous:"previous image",next:"next image",close:"close",slideshowStart:"play slideshow",slideshowStop:"stop slideshow",linkTo:"Open Image in a new window",linkToShow:1,seemsError:"There seems to be an Error",errorClose:"Close Pirobox"},b);function c(){var v='<tr><td colspan="3" class="pirobox_up"></td></tr><tr><td class="t_l"></td><td class="t_c"></td><td class="t_r"></td></tr><tr><td class="c_l"></td><td class="c_c"><span><span></span></span><div id="pirobox-image"></div></td><td class="c_r"></td></tr><tr><td class="b_l"></td><td class="b_c"></td><td class="b_r"></td></tr><tr><td colspan="3" class="pirobox_down"></td></tr>';var t=a(document).height();var s=a(jQuery('<div class="piro_overlay"></div>').hide().css({opacity:+b.bg_alpha,height:t+"px"}));var n=a(jQuery('<table class="pirobox_content" cellpadding="0" cellspacing="0"></table>'));var A=a(jQuery('<div class="caption"></div>'));var f=a(jQuery('<div class="piro_nav"></div>'));var w=a(jQuery('<a href="#close" class="piro_close" title="'+b.close+'"></a>'));var u=a(jQuery('<a href="#play" class="play" title="'+b.slideshowStart+'"></a>'));var p=a(jQuery('<a href="#stop" class="stop" title="'+b.slideshowStop+'"></a>'));var k=a(jQuery('<a href="#prev" class="piro_prev" title="'+b.previous+'"></a>'));var m=a(jQuery('<a href="#next" class="piro_next" title="'+b.next+'"></a>'));a("body").append(s).append(n);n.append(v);a(".pirobox_up").append(w);a(".pirobox_down").append(f);a(".pirobox_down").append(u);u.hide();a(".pirobox_down").append(k).append(m);f.append(A);var e=k.width();n.hide();var B=a("a[class^='pirobox']");var C=new Object();for(var z=0;z<B.length;z++){var j=a(B[z]);C["a."+j.attr("class")]=0}var r=new Array();for(var E in C){var q=E.split(" ",1);r.push(q[0])}for(var z=0;z<r.length;z++){a(r[z]).each(function(i){this.rel=i+1+" "+b.current+" "+a(r[z]).length});var d=a(r[z]+":first").addClass("first");var x=a(r[z]+":last").addClass("last")}a(B).each(function(i){this.rev=i+0});var l=a(B).each(function(){this.href});var y=a("body").append('<div id="imgCache" style="display:none"></div').children("#imgCache");a.each(l,function(F,G){a("<div/>").css({background:"url("+G+")"}).appendTo(y)});var o=a(B);a.fn.fixPNG=function(){return this.each(function(){var i=a(this).css("backgroundImage");if(i.match(/^url\(["']?(.*\.png)["']?\)$/i)){i=RegExp.$1;a(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod="+(a(this).css("backgroundRepeat")=="no-repeat"?"crop":"scale")+", src='"+i+"')"}).each(function(){var F=a(this).css("position");if(F!="absolute"&&F!="relative"){a(this).css("position","relative")}})}})};a.browser.msie6=(a.browser.msie&&/MSIE 6\.0/i.test(window.navigator.userAgent));if(a.browser.msie6&&!/MSIE 8\.0/i.test(window.navigator.userAgent)){a(".t_l,.t_c,.t_r,.c_l,.c_r,.b_l,.b_c,.b_r,a.piro_next, a.piro_prev,a.piro_prev_out,a.piro_next_out,.c_c,.piro_close,a.play,a.stop").fixPNG();var h=a(document).height();s.css("height",h+"px")}if(a.browser.msie){b.close_speed=0}a(window).resize(function(){var i=a(document).height();s.css({visibility:"visible",height:+i+"px"})});k.add(m).bind("click",function(G){G.preventDefault();var i=parseInt(a(o).filter(".item").attr("rev"));var F=a(this).is(".piro_prev_out,.piro_prev")?a(o).eq(i-1):a(o).eq(i+1);if(!F.size()){F=a(this).is(".piro_prev_out,.piro_prev")?a(o).eq(a(o).size()-1):a(o).eq(0)}F.click();w.add(A).add(m).add(k).css("visibility","hidden")});a(o).each(function(F){var i=a(this);i.unbind();i.bind("click",function(L){L.preventDefault();g(i.attr("href"));var I=i.attr("href");var K=i.attr("title");var G=i.attr("longdesc");var J=i.attr("rel");var H="";if(b.linkToShow==0){H="<a href="+I+' class="link_to" target="_blank" title="'+b.linkTo+'"></a>'}if(K==""){A.html("<p>"+I+'<em class="number">'+J+"</em>"+H+"</p>")}else{if(G!=""){A.html("<p>"+G+'<em class="number">'+J+"</em>"+H+"</p>")}else{A.html("<p>"+K+'<em class="number">'+J+"</em>"+H+"</p>")}}if(i.is(".last")){a(".number").css("text-decoration","underline")}else{a(".number").css("text-decoration","none")}if(i.is(".first")){k.hide();m.show()}else{m.add(k).show()}if(i.is(".last")){k.show();m.hide();u.css("width","0")}else{u.css("width","40px")}if(i.is(".last")&&i.is(".first")){k.add(m).hide();a(".number").hide();u.remove()}a(o).filter(".item").removeClass("item");i.addClass("item");a(".c_c").removeClass("unique")})});var g=function(i){u.add(p).hide();w.add(A).add(m).add(k).css("visibility","hidden");if(n.is(":visible")){a(".c_c div").children().fadeOut(300,function(){a(".c_c div").children().remove();D(i)})}else{a(".c_c div").children().remove();n.show();s.fadeIn(300,function(){D(i)})}};var D=function(H){if(n.is(".loading")){return}n.addClass("loading");var F=new Image();F.onerror=function(){var J=a(n).height();n.css({marginTop:parseInt(a(document).scrollTop())-(J/1.9)});a(".c_c div").append('<p class="err_mess">'+b.seemsError+':&nbsp;<a href="#close" class="close_pirobox">'+b.errorClose+"</a></p>");a(".close_pirobox").bind("click",function(K){K.preventDefault();w.add(s).add(n).add(A).add(m).add(k).hide(0,function(){F.src=""});n.removeClass("loading")})};F.onload=function(){var O=F.height;var M=F.width;var N=a(n).height();var L=a(window).height();var K=a(window).width();a(F).height(O).width(M).hide();a(".c_c div").animate({height:O+"px",width:M+"px"},b.my_speed);var J=O/L*2.3;if(L<O){h_fix=J}else{h_fix=2}n.animate({height:(O+40)+"px",width:(M+40)+"px",marginLeft:"-"+((M)/2+20)+"px",marginTop:parseInt(a(document).scrollTop())-(O/h_fix)},b.my_speed,function(){a(".piro_nav,.caption").css({width:(M)+"px","margin-bottom":"10px"});a(".piro_nav").css("margin-left","-"+(M)/2+"px");var P=A.height();a(".c_c div").append(F);w.css("display","block");m.add(k).add(w).css("visibility","visible");A.css({visibility:"visible",display:"block",opacity:"0.8",overflow:"hidden"});n.hover(function(){A.stop().fadeTo(200,0.8)},function(){A.stop().fadeTo(200,0)});if(b.imgBlur==false){a(F).fadeIn(300)}else{a(F).fadeIn(1,function(){a(this).blurRadius(b.imgBlurRadius,function(){var R=0;var S=setInterval(function(){a("div#pirobox-image img").css("visibility","visible");a("#autosvgcontainer").fadeOut();R++;Q(R)},b.blurTime);function Q(T){if(T==1){clearInterval(S)}}})})}n.removeClass("loading");if(b.slideShow===true){u.add(p).show()}else{u.add(p).hide()}})};F.src=H;a("html").bind("keyup",function(J){if(J.keyCode==27){J.preventDefault();if(a(F).is(":visible")||a(".c_c>div>p>a").is(".close_pirobox")){a(o).removeClass("slideshow").removeClass("item");w.add(s).add(n).add(A).add(m).add(k).hide(0,function(){F.src=""});n.removeClass("loading");clearTimeout(I);a(o).children().removeAttr("class");a(".stop").remove();a(".c_c").append(u);a(".sc_menu").css("display","none");a("ul.sc_menu li a").removeClass("img_active").css("opacity","0.4");m.add(k).show().css({top:"50%"});a(o).children().fadeTo(100,1)}}});a("html").bind("keyup",function(J){if(a(".item").is(".first")){}else{if(J.keyCode==37){J.preventDefault();if(a(F).is(":visible")){clearTimeout(I);a(o).children().removeAttr("class");a(".stop").remove();a(".c_c").append(u);k.click()}}}});a("html").bind("keyup",function(J){if(a(".item").is(".last")){}else{if(J.keyCode==39){J.preventDefault();if(a(F).is(":visible")){clearTimeout(I);a(o).children().removeAttr("class");a(".stop").remove();a(".c_c").append(u);m.click()}}}});var i=a(window).height();p.bind("click",function(J){J.preventDefault();clearTimeout(I);a(o).removeClass("slideshow");a(".stop").remove();a(".pirobox_down").append(u);m.add(k).css("width",e+"px")});u.bind("click",function(J){J.preventDefault();clearTimeout(I);if(a(F).is(":visible")){a(o).addClass("slideshow");a(".play").remove();a(".pirobox_down").append(p)}m.add(k).css({width:"0px"});return G()});a(b.close_all).bind("click",function(J){a(o).removeClass("slideshow");clearTimeout(I);if(a(F).is(":visible")){J.preventDefault();w.add(s).add(n).add(A).add(m).add(k).hide(0,function(){F.src=""});n.removeClass("loading");a(o).removeClass("slideshow");m.add(k).css("width",e+"px").hide();a(".stop").remove();a(".pirobox_down").append(u);u.hide()}});if(b.slideShow===true){function G(){if(a(o).filter(".item").is(".last")){clearTimeout(I);a(o).removeClass("slideshow");a(".stop").remove();a(".pirobox_down").append(u);m.add(k).css("width",e+"px")}else{if(a(o).is(".slideshow")&&a(F).is(":visible")){clearTimeout(I);m.click()}}}var I=setInterval(G,b.slideSpeed*1000)}}}c()}})(jQuery);
