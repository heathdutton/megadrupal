<?php
/**
 * @file
 * Requirements function for the Pirobox media module.
 */

/**
 * Implements hook_requirements().
 */
function pirobox_media_requirements($phase) {
  $requirements = array();

  // Check Media module version. Needed is 2.
  switch ($phase) {
    case 'install':
    case 'update':
      $t = get_t();
      $info = drupal_parse_info_file(drupal_get_path('module', 'media') . '/media.info');

      if (!preg_match('/7\.x-2/', $info['version'])) {
        $requirements['media_module'] = array(
          'title' => $t('Media module'),
          'severity' => REQUIREMENT_ERROR,
          'value' => $t('At least 2'),
          'description' => $t('Media module version 2 is provided.')
        );
      }

      break;
  }

  return $requirements;
}
