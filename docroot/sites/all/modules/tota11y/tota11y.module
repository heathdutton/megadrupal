<?php

/**
 * @file Module for tota11y.
 */

/**
 * Implements hook_libraries_info().
 */
function tota11y_libraries_info() {
  $libraries['tota11y'] = array(
    'name' => 'tota11y',
    'vendor url' => 'http://khan.github.io/tota11y/',
    'download url' => 'https://github.com/Khan/tota11y/releases/latest',
    'version callback' => 'tota11y_version_callback',
    'files' => array(
      'js' => array('tota11y.min.js'),
    ),
  );
  return $libraries;
}

/**
 * Implements hook_permission().
 */
function tota11y_permission() {
  return array(
    'use tota11y' => array(
      'title' => t('Use tota11y'),
      'description' => t('Use the tota11y toolbar.'),
    ),
  );
}

/**
 * Implements hook_preprocess_HOOK().
 */
function tota11y_preprocess_page(&$variables) {
  if (!user_access('use tota11y')) {
    return;
  }
  if ($library = libraries_get_path('tota11y')) {
    drupal_add_js($library . '/tota11y.min.js', array('type' => 'file', 'scope' => 'footer'));
  }
}

/**
 * Version callback.
 */
function tota11y_version_callback() {
  return TRUE;
}
