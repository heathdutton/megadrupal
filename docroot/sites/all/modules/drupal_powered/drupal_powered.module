<?php

/**
 * Implements hook_block_info().
 */
function drupal_powered_block_info() {
  return array('powered' => array(
    'info' => t("Powered by Drupal (wordmark)"),
    'cache' => DRUPAL_CACHE_GLOBAL,
  ));
}

/**
 * Implements hook_block_configure().
 */
function drupal_powered_block_configure($delta = '') {
  $form = array();
  $form['website'] = array(
    '#title' => t("Link website"),
    '#type' => 'radios',
    '#options' => array(
      'http://drupal.com/' => 'drupal.com',
      'https://www.drupal.org/' => 'drupal.org',
    ),
    '#default_value' => variable_get('drupal_powered_website'),
    '#description' => t("Most websites should link to drupal.com. Only websites related to web development should link to drupal.org."),
  );
  return $form;
}

/**
 * Implements hook_block_save().
 */
function drupal_powered_block_save($delta = '', array $edit = array()) {
  variable_set('drupal_powered_website', $edit['website']);
}

/**
 * Implements hook_block_view().
 */
function drupal_powered_block_view($delta = '') {
  $image = theme('image', array(
    'path' => variable_get('drupal_powered_wordmark'),
    'alt' => "Drupal",
  ));
  $link = l($image, variable_get('drupal_powered_website'), array(
    'html' => TRUE,
    'attributes' => array('target' => '_blank'),
  ));
  return array(
    'subject' => t("Powered by"),
    'content' => $link,
  );
}
