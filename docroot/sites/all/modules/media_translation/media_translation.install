<?php
/**
 * @file
 * Install/Uninstall processing for the module.
 */

/**
 * Implements hook_install().
 */
function media_translation_install() {
  module_load_install('i18n');
  module_load_install('i18n_sting');
  module_load_install('i18n_translation');
  i18n_install_create_fields('file_managed', array('language', 'i18n_tsid'));
  i18n_install_create_fields('media_type', array('language', 'i18n_mode'));
}

/**
 * Implements hook_uninstall().
 */
function media_translation_uninstall() {
  db_drop_field('file_managed', 'language');
  db_drop_field('file_managed', 'i18n_tsid');
  db_drop_field('media_type', 'language');
  db_drop_field('media_type', 'i18n_mode');
}

/**
 * Implements hook_field_schema().
 */
function media_translation_field_schema($field) {
  module_load_install('media');
  return media_field_schema($field);
}

/**
 * Implements hook_schema_alter().
 */
function media_translation_schema_alter(&$schema) {
  $schema['media_type']['fields']['language'] = array('type' => 'varchar', 'length' => 12, 'not null' => TRUE, 'default' => LANGUAGE_NONE);
  $schema['media_type']['fields']['i18n_mode'] = array('type' => 'int', 'unsigned' => TRUE, 'not null' => TRUE, 'default' => 0);
  $schema['file_managed']['fields']['language'] = array('type' => 'varchar', 'length' => 12, 'not null' => TRUE, 'default' => LANGUAGE_NONE);
  $schema['file_managed']['fields']['i18n_tsid'] = array('type' => 'int', 'unsigned' => TRUE, 'not null' => TRUE, 'default' => 0);
}

function media_translation_update_6100() {
  //  update i18n_translation_set set type='file' where type='file_managed';
  $query = db_update('i18n_translation_set')->fields(array('type' => 'file'))->condition('type', 'file_managed');
  $query->execute();
}
