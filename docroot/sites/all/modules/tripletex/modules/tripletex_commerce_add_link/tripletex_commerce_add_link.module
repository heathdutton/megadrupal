<?php
/**
 * Implements hook_menu().
 */
function tripletex_commerce_add_link_menu() {
	$items['product/add/%/%'] = array (
			'page callback' => 'tripletex_commerce_add_link_product_add',
			'page arguments' => array(2,3),
			'access arguments' => array('access content'),
			'type' => MENU_CALLBACK,
	);
	return $items;
}

/**
 * Custom function to add product(s) to a cart by product id
 */
function tripletex_commerce_add_link_product_add($pid,$quantity=1) {
	if ($product = commerce_product_load($pid) ) {
		global $user;
		$uid = $user->uid;
		$line_item = commerce_product_line_item_new($product, $quantity);
		$line_item->field_ticket_type['und'][]['value'] = 0;
		$line_item = commerce_cart_product_add($uid, $line_item, true);
		drupal_goto('checkout');
	}
}