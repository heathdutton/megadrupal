<?php

/**
 * Implementation of hook_requirements().
 */
function reverse_proxy_check_requirements($phase) {
  $requirements = array();

  // We only run this for the status report
  if($phase != 'runtime') {
    return array();
  }

  $working = reverse_proxy_check_site();

  $requirements['reverse_proxy_check'] = array(
    'title' => t('Reverse proxy status'),
    'value' => NULL,
    'description' => $working ? t('Your reverse proxy is serving cached content to anonymous traffic on the homepage.')
      : t('Oh noes! Your reverse proxy is not serving cached content to anonymous visitors to the home page.'),
    'severity' => $working ? REQUIREMENT_OK : REQUIREMENT_ERROR,
  );

  return $requirements;
}