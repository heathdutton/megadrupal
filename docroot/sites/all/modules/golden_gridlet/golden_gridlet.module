<?php
/**
 * @file
 * Drupal hooks to provide Golden Gridlet integration.
 *
 * This is the main module file for Golden Gridlet. Apart from integrating
 * with the permissions and menu systems, this file is responsible for
 * including the necessary JavaScript to display the gridlet on all pages,
 * provided the current user has the requisite permissions.
 */

/**
 * Implements hook_permission().
 */
function golden_gridlet_permission() {
  return array(
    'view golden gridlet' => array(
      'title' => t('View Golden Gridlet'),
      'description' => t('View the Golden Gridlet toggle on each page'),
    ),
    'administer golden gridlet' => array(
      'title' => t('Administer Golden Gridlet'),
      'description' => t('Adjust Golden Gridlet size, breakpoints and appearance'),
    ),
  );
}

/**
 * Implements hook_init().
 */
function golden_gridlet_init() {
  if (user_access('view golden gridlet')) {
    drupal_add_js(
      array(
        'golden_gridlet' => array(
          'guideColor' => variable_get('golden_gridlet_guide_color', '#FFC300'),
          'guideInnerColor' => variable_get('golden_gridlet_guide_inner_color', '#FFFFFF'),
          'guideOpacity' => variable_get('golden_gridlet_guide_opacity', '0.618'),
          'switchColor' => variable_get('golden_gridlet_switch_color', '#000000'),
          'switchOpacity' => variable_get('golden_gridlet_switch_opacity', '0.618'),
          'baseFontSize' => variable_get('golden_gridlet_base_font_size', '16'),
          'baselineGridHeight' => variable_get('golden_gridlet_baseline_grid_height', '1.5'),
          'eightColBreakpoint' => variable_get('golden_gridlet_eight_col_breakpoint', '45'),
          'sixteenColBreakpoint' => variable_get('golden_gridlet_sixteen_col_breakpoint', '117'),
          'gutterSize' => variable_get('golden_gridlet_gutter_size', '1.5'),
        ),
      ),
      'setting'
    );
    drupal_add_js(drupal_get_path('module', 'golden_gridlet') . '/ggs.js');
  }
}

/**
 * Implements hook_menu().
 */
function golden_gridlet_menu() {
  $items['admin/config/development/gridlet'] = array(
    'title' => 'Golden Gridlet Settings',
    'description' => 'Adjust the color, size, and breakpoints of the Golden Gridlet',
    'type' => MENU_NORMAL_ITEM,
    'access arguments' => array('administer golden gridlet'),
    'file' => 'golden_gridlet.admin.inc',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('golden_gridlet_admin_form'),
  );

  return $items;
}
