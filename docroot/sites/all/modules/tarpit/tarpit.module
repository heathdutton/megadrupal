<?php

module_load_include('inc', 'tarpit', 'tarpit.helpers');

/**
 * Implements hook_menu().
 */
function tarpit_menu() {
  $items = array();
  $paths = \Drupal\tarpit\Config::get('tarpit.paths');
  $title = \Drupal\tarpit\Config::get('tarpit.page_title');

  foreach($paths as $path) {
    $items[$path] = array(
      'title' => $title,
      'page callback' => '_tarpit_get_page',
      'access arguments' => array('access tarpit'),
      'file' => 'tarpit.pages.inc',
      'type' => MENU_CALLBACK,
    );
  }

  return $items;
}

/**
 * Implements hook_permission().
 */
function tarpit_permission() {
  return array(
    'access tarpit' => array(
      'title' => 'Access Tarpit',
      'description' => 'Access Tarpit'
    ),
  );
}

/**
 * Implements hook_tarpit_content_alter().
 */
function tarpit_tarpit_content_alter(&$markup, $config) {
  $markup['default']['#markup'] = _tarpit_generate_content(current_path(), $config['size'], $config['links'], $config['wordlist']);
}

/**
 * Implements hook_hook_info().
 */
function tarpit_hook_info() {
  $hooks['tarpit_view'] = array(
    'group' => 'tarpit',
  );
  $hooks['tarpit_reaction'] = array(
    'group' => 'tarpit',
  );

  return $hooks;
}