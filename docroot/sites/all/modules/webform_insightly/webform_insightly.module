<?php
/**
 * @file
 * Includes content management hook functions.
 */

/**
 * Implements hook_menu().
 */
function webform_insightly_menu() {
  $items = array();
  $items['admin/config/insightly-mapping/add'] = array(
    'title' => 'Mapping',
    'description' => 'A form for mapping of webform fields.',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('webform_insightly_add_form'),
    'access arguments' => array('access administration pages'),
    'file' => 'webform_insightly.admin.inc',
    'type' => MENU_CALLBACK,
  );
  $items['admin/insightly-mapping/edit/%'] = array(
    'title' => 'Mapping',
    'description' => 'A form for mapping of webform fields.',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('webform_insightly_edit_form', 3),
    'access arguments' => array('access administration pages'),
    'file' => 'webform_insightly.admin.inc',
    'type' => MENU_CALLBACK,
  );
  $items['admin/insightly-mapping/delete/%'] = array(
    'title' => 'Mapping',
    'description' => 'A form for mapping of webform fields.',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('webform_insightly_delete_form', 3),
    'access arguments' => array('access administration pages'),
    'file' => 'webform_insightly.admin.inc',
    'type' => MENU_CALLBACK,
  );
  $items['admin/insightly-mapping/export/%'] = array(
    'title' => 'Export Insightly Mapping Fields',
    'description' => 'A form for export mapping of webform fields.',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('webform_insightly_export_form', 3),
    'access arguments' => array('access administration pages'),
    'file' => 'webform_insightly.admin.inc',
    'type' => MENU_CALLBACK,
  );
  $items['admin/insightly-mapping/import'] = array(
    'title' => 'Import Insightly Mapping Fields',
    'description' => 'A form for import mapping of webform fields.',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('webform_insightly_import_form'),
    'access arguments' => array('access administration pages'),
    'file' => 'webform_insightly.admin.inc',
    'type' => MENU_CALLBACK,
  );
  return $items;
}

/**
 * Implements hook_init().
 */
function webform_insightly_init() {
  drupal_add_css(drupal_get_path('module', 'webform_insightly') . '/css/webform_insightly.css');
}

/**
 * Implements hook_webform_submission_insert().
 *
 * Integration with Insightly.
 *   Used to sent data to Insightly in webform submissions.
 */
function webform_insightly_webform_submission_insert($node, $submission) {
  include_once 'webform_insightly.inc';
  webform_insightly_map_fields($node, $submission);
}
