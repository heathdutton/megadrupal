(function(e){Drupal.behaviors.profileDrag={attach:function(t,n){var r=e("#profile-fields"),i=Drupal.tableDrag["profile-fields"];i.row.prototype.onSwap=function(t){var n=this;e("tr.category-message",r).each(function(){e(this).prev("tr").get(0)==n.element&&(n.method!="keyboard"||n.direction=="down")&&n.swap("after",this),e(this).next("tr").is(":not(.draggable)")||e(this).next("tr").length==0?e(this).removeClass("category-populated").addClass("category-empty"):e(this).is(".category-empty")&&e(this).removeClass("category-empty").addClass("category-populated")})},i.onDrop=function(){dragObject=this;if(e(dragObject.rowObject.element).prev("tr").is(".category-message")){var t=e(dragObject.rowObject.element).prev("tr").get(0),n=t.className.replace(/([^ ]+[ ]+)*category-([^ ]+)-message([ ]+[^ ]+)*/,"$2"),r=e("select.profile-category",dragObject.rowObject.element),i=e("select.profile-weight",dragObject.rowObject.element),s=i[0].className.replace(/([^ ]+[ ]+)*profile-weight-([^ ]+)([ ]+[^ ]+)*/,"$2");r.is(".profile-category-"+n)||(r.removeClass("profile-category-"+s).addClass("profile-category-"+n),i.removeClass("profile-weight-"+s).addClass("profile-weight-"+n),r.val(r[0].options[n].value))}}}}})(jQuery);