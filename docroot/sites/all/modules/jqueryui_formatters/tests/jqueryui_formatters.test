<?php
/**
 * @file
 * Tests for jqueryui_formatters.module.
 */

/**
 * Tests for number field types.
 */
class JqueryuiFormattersCase extends DrupalWebTestCase {
  protected $field;
  protected $instance;
  protected $webUser;

  public static function getInfo() {
    return array(
      'name'  => 'jqueryui formatters',
      'description'  => 'Test that any jqueryui formatter settings summary does not generate warnings.',
      'group' => 'Field UI'
    );
  }

  function setUp() {
    parent::setUp('field_test', 'jqueryui_formatters');
    $this->webUser = $this->drupalCreateUser(array('access field_test content', 'administer field_test content', 'administer content types'));
    $this->drupalLogin($this->webUser);

    // Display the "Add content type" form.
    $this->drupalGet('admin/structure/types/add');

  }

  /**
   * Test number_integer field.
   */
  function testWarningsSettingsJqueryuiFormatters() {
    // Add a content type.
    $name = $this->randomName();
    $type = drupal_strtolower($name);
    $edit = array('name' => $name, 'type' => $type);
    $this->drupalPost(NULL, $edit, t('Save and add fields'));

    // Add an integer field to the newly-created type.
    $label = $this->randomName();
    $field_name = drupal_strtolower($label);
    $edit = array(
      'fields[_add_new_field][label]' => $label,
      'fields[_add_new_field][field_name]' => $field_name,
      'fields[_add_new_field][type]' => 'text',
      'fields[_add_new_field][widget_type]' => 'text_textfield',
    );
    $this->drupalPost(NULL, $edit, t('Save'));
    // Set the formatter to "Dialog", "Accordion" and to "Tabs", and just
    // check that the settings summary does not generate warnings.
    $this->drupalGet("admin/structure/types/manage/$type/display");
    $edit = array(
      "fields[field_$field_name][type]" => 'jqueryui_formatters_dialog',
    );
    $this->drupalPost(NULL, $edit, t('Save'));
    $edit = array(
      "fields[field_$field_name][type]" => 'jqueryui_formatters_accordion',
    );
    $this->drupalPost(NULL, $edit, t('Save'));
    $edit = array(
      "fields[field_$field_name][type]" => 'jqueryui_formatters_tabs',
    );
    $this->drupalPost(NULL, $edit, t('Save'));
  }

}
