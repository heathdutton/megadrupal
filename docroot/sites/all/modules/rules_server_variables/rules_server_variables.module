<?php

/**
 * @file
 *   Drupal rules server variable integration.
 */

/**
 * Comapres a server variable to the passed in string.
 * @param  String
 *  $variable
 * @param  String
 *  $compare
 * @return boolean
 */
function rules_server_variables_compare($variable, $compare, $operator) {
  if (!empty($_SERVER[$variable])) {
    switch($operator) {
      case 'greater_than':
        return $_SERVER[$variable] > $compare;
      break;
      case 'less_than':
        return $_SERVER[$variable] < $compare;
      break;
      case 'equal_to':
        return $_SERVER[$variable] == $compare;
      break;
      case 'contains':
        if (strstr($_SERVER[$variable], $compare)) {
          return TRUE;
        }
      break;
      case 'regex' :
        if (preg_match($compare, $_SERVER[$variable])) {
          return TRUE;
        }
      break;
    }
  }
  return FALSE;
}

/**
 * Provides an option list of comparison operators.
 */
function rules_server_variables_operators_list() {
  return array(
    'greater_than' => t('Greater than'),
    'less_than' => t('Less than'),
    'equal_to' => t('Equal to'),
    'contains' => t('Contains'),
    'regex' => t('Regular Expression Match'),
  );
}
