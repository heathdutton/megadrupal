<?php
/**
 * @file
 * Checkmate sample module file.
 */

/**
 * Implements hook_admin_paths().
 */
function checkmate_sample_admin_paths() {
  $paths = array(
    drupal_lookup_path('source', 'admin/reports/checkmate') => TRUE,
  );
  return $paths;
}

/**
 * Implements hook_views_api().
 */
function checkmate_sample_views_api() {
  return array(
    'api' => 3,
    'path' => drupal_get_path('module', 'checkmate_sample'),
  );
}

/**
 * Implements hook_default_rules_configuration().
 */
function checkmate_sample_default_rules_configuration() {
  $rule = rules_reaction_rule();
  $rule->label = 'Send mail after checkmate status creation';
  $rule->active = TRUE;
  $rule->event('checkmate_item_status_insert')
  ->action('mail',
    array(
      'to' => 'example@xio.be',
      'language' => LANGUAGE_NONE,
      'subject' => '[checkmate-item-status:cid:title]',

      'message' => 'Status update to [checkmate-item-status:checkmate-status] by [checkmate-item-status:checkmate-user]

[checkmate-item-status:checkmate-comment]

Sincerely,

The Checkmate module',
    ));
  $configs['rules_send_mail_after_checkmate_status_creation'] = $rule;
  return $configs;
}

function checkmate_sample_node_access($node, $op, $account) {
  if (isset($node->type) && $node->type == 'checkmate_display') {
    if (!user_access('view checkmate display nodes')) {
      return NODE_ACCESS_DENY;
    }
  }
  return NODE_ACCESS_IGNORE;
}

/**
 * Implements hook_permission().
 */
function checkmate_sample_permission() {
  $permissions = array(
    'view checkmate display nodes' => array(
      'title' => t('View checkmate display nodes'),
      'restrict access' => FALSE,
    ),
  );
  return $permissions;
}