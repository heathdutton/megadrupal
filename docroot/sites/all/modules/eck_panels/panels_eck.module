<?php

/**
 * Implements hook_ctools_plugin_directory()
 */
function panels_eck_ctools_plugin_directory($module, $plugin) {
  if (in_array($module, array('panelizer', 'ctools', 'page_manager'))) {
    return 'plugins/' . str_replace('_', '-', $plugin);
  }
}

/**
 * Implements hook_panelizer_entity().
 *
 * @see https://www.drupal.org/node/2155565#comment-9558929
 */
function panels_eck_panelizer_entity() {
  $return = array();
  $path = drupal_get_path('module', 'panels_eck');
  foreach (EntityType::loadAll() as $entity_type) {
    $return[$entity_type->name] = array(
      'handler' => array(
        'class' => 'PanelizerEntityConstructionKit',
        'file' => 'PanelizerEntityConstructionKit.php',
        'path' => "$path/includes",
      ),
      'uses page manager' => TRUE,
      'name' => $entity_type->name,
      'hooks' => array(
        'menu' => TRUE,
        'admin_paths' => TRUE,
        'permission' => TRUE,
        'panelizer_defaults' => TRUE,
        'default_page_manager_handlers' => TRUE,
        'form_alter' => TRUE,
        'views_data_alter' => TRUE,
      ),
    );
  }

  return $return;
}
