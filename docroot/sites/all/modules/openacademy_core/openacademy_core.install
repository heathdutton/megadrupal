<?php

/**
 * Open Academy Beta 4 Update: Enable admin theme, and switch to google fonts.
 */
function openacademy_core_update_7001(&$sandbox) {
  variable_set('admin_theme', 'adminimal');
  variable_set('node_admin_theme', 1);
  
  // Enable google webfont provider and disable fontsquirrel.
  module_enable(array('google_fonts_api'));
  module_disable(array('fontsquirrel'));

  // Don't load custom font in the admin theme.
  variable_set('fontyourface_load_everywhere', FALSE);
}

/**
 * Open Academy Beta 5 Update: Switch to unary admin theme
 */
function openacademy_core_update_7002(&$sandbox) {
  variable_set('admin_theme', 'unary');
}

/**
 * Open Academy 1.0 Update: Switch to Locke theme, reset permissions, enable openacademy_core_update
 */
function openacademy_core_update_7003(&$sandbox) {
  $current_theme = variable_get('theme_default', 'openacademy_default');
  if ($current_theme == 'openacademy_default') {
    variable_set('theme_default', 'locke');
    $theme_settings = variable_get('theme_openacademy_default_settings', array());
    variable_set('theme_locke_settings', $theme_settings);
  }

  // Revert permissions to default state.
  features_include();
  $components = defaultconfig_get_components();
  $permissions_component = $components['user_default_permissions'];
  defaultconfig_component_rebuild($permissions_component);
  
  module_enable(array('openacademy_core_update'));
}
