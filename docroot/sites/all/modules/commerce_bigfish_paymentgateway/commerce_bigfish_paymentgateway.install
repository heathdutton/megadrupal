<?php
/**
 * @file
 * Delete created variables after module uninstall.
 */

/**
 * Implements hook_requirements().
 */
function commerce_bigfish_paymentgateway_requirements($phase) {
  $requirements = array();
  $t = get_t();
  switch ($phase) {
    case 'install':
    case 'runtime':
      module_load_include('inc', 'commerce_bigfish_paymentgateway', 'includes/commerce_bigfish_paymentgateway.define');
      $sdk_path = libraries_get_path(COMMERCE_BIGFISH_PAYMENTGATEWAY_LIBRARY_NAME);

      if (!file_exists($sdk_path . '/src/BigFish/PaymentGateway/Autoload.php')) {
        $requirements['commerce_bigfish_paymentgateway'] = array(
          'title' => 'Commerce BIG FISH Paymentgateway',
          'value' => $t('!library library missing', array(
            '!library' => l($t('BIG FISH Paymentgateway PHP SDK'), COMMERCE_BIGFISH_PAYMENTGATEWAY_LIBRARY_URL_DOWNLOAD, array('attributes' => array('target' => 'blank'))),
          )),
          'description' => $t('!module module requires !library. Download from !url in a ZIP file and unpack into %path folder.', array(
            '!module' => 'Commerce BIG FISH Paymentgateway',
            '!library' => l($t('BIG FISH Paymentgateway PHP SDK'), COMMERCE_BIGFISH_PAYMENTGATEWAY_LIBRARY_URL_INFO, array('attributes' => array('target' => 'blank'))),
            '!url' => l(COMMERCE_BIGFISH_PAYMENTGATEWAY_LIBRARY_URL_DOWNLOAD, COMMERCE_BIGFISH_PAYMENTGATEWAY_LIBRARY_URL_DOWNLOAD, array('attributes' => array('target' => 'blank'))),
            '%path' => 'sites/all/libraries/' . COMMERCE_BIGFISH_PAYMENTGATEWAY_LIBRARY_NAME,
          )),
          'severity' => REQUIREMENT_ERROR,
        );
      }
      break;
  }
  return $requirements;
}

/**
 * Implements hook_uninstall().
 */
function commerce_bigfish_paymentgateway_uninstall() {
  variable_del('commerce_bigfish_paymentgateway_store_name');
  variable_del('commerce_bigfish_paymentgateway_api_key');
  variable_del('commerce_bigfish_paymentgateway_test_mode');
  variable_del('commerce_bigfish_paymentgateway_encryption_key');
}
