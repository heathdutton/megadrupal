<?php

/**
 * Implements hook_theme().
 */
function commerce_prettyshipping_theme() {
  return array(
    'commerce_prettyshipping_label' => array(
      'template' => 'commerce_prettyshipping_label',
      'variables' => array('shipping_service' => NULL),
    ),
  );
}


/**
 * Implements hook_form_alter().
 */
function commerce_prettyshipping_form_commerce_checkout_form_shipping_alter(&$form, $form_state) {
  $rates = $form['commerce_shipping']['shipping_rates']['#value'];
  unset($form['commerce_shipping']['shipping_service']['#ajax']);
  foreach ($form['commerce_shipping']['shipping_service']['#options'] as $key => &$option) {
    $option = theme('commerce_prettyshipping_label', array(
      'shipping_service' => $rates[$key],
    ));
  }

  $form['#attached']['css'][] = drupal_get_path('module', 'commerce_prettyshipping') . '/commerce_prettyshipping.css';
}
