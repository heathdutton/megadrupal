<?php

/**
 * @file
 * Code for the Nyan cat progress bar module.
 */

/**
 * Implements hook_init().
 */
function nyan_init() {
  drupal_add_css(drupal_get_path('module', 'nyan') . '/css/nyan.css');
  drupal_add_js(array(
    'nyan' => array(
      'audio' => array(
        'enabled' => variable_get('nyan_audio_enabled', 1),
        'ogg' => url(drupal_get_path('module', 'nyan') . '/audio/nyancat.ogg'),
        'mp3' => url(drupal_get_path('module', 'nyan') . '/audio/nyancat.mp3'),
        'show_controls' => variable_get('nyan_audio_show_controls', 1),
        'initial_volume' => variable_get('nyan_audio_initial_volume', '.50'),
      ),
    ),
  ), 'setting');
}

/**
 * Implements hook_permission().
 */
function nyan_permission() {
  return array(
    'administer nyan' => array(
      'title' => t('Administer the <em>Nyan cat</em> progress bar.'),
      'description' => t('Give this access to anyone that should be able to administer the settings to the Nyan cat progress bar.'),
    ),
  );
}

/**
 * Implements hook_menu().
 */
function nyan_menu() {
  $items['admin/config/system/nyan'] = array(
    'title' => 'Nyan cat progress bar',
    'description' => 'Customize the Nyan cat progress bar to your site.',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('nyan_general_settings'),
    'file' => 'nyan.general.admin.inc',
    'access arguments' => array('administer nyan'),
    'type' => MENU_NORMAL_ITEM,
  );
  return $items;
}

/**
 * Implements hook_js_alter().
 */
function nyan_js_alter(&$javascript) {
  // Swap out progress.js to use our version of the library.
  $javascript['misc/progress.js'] = drupal_js_defaults(drupal_get_path('module', 'nyan') . '/js/progress.js');
}
