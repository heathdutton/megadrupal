<?php

/**
 * @file
 * Integrates Cloudwords with i18n_contact.module.
 */


/**
 * Implements hook_cloudwords_translatable_info().
 */
function cloudwords_i18n_contact_cloudwords_translatable_info() {
  return array(
    'contact_category' => array(
      'controller class' => 'CloudwordsI18nStringSource',
    ),
  );
}

/**
 * Implements hook_form_FORM_ID_alter().
 */
function cloudwords_i18n_contact_form_contact_category_edit_form_alter(&$form, &$form_state) {
  if (!empty($form['cid']['#value'])) {
    $args = array(
      'textgroup' => 'contact',
      'type' => 'contact_category',
      'objectid' => $form['cid']['#value'],
    );

    cloudwords_outdated_form($form, $form_state, $args);
  }

  $form['#submit'][] = 'cloudwords_i18n_contact_category_edit_form_submit';
}

/**
 * Create/update translatables for contact forms.
 */
function cloudwords_i18n_contact_category_edit_form_submit($form, &$form_state) {
  $objectid = $form_state['values']['cid'];
  $label = $form_state['values']['contact_category'];
  cloudwords_i18n_ensure_translatables('contact', 'contact_category', $objectid, $label);
}

/**
 * Implements hook_form_FORM_ID_alter().
 */
function cloudwords_i18n_contact_form_contact_category_delete_form_alter(&$form, &$form_state) {
  $form['#submit'][] = 'cloudwords_i18n_contact_form_contact_category_delete_form_submit';
}

/**
 * Remove translatables for deleted categories.
 */
function cloudwords_i18n_contact_form_contact_category_delete_form_submit($form, &$form_state) {
  cloudwords_translatable_delete_by_property(array(
    'textgroup' => 'contact',
    'type' => 'contact_category',
    'objectid' => $form_state['values']['contact']['cid'],
  ));
}

/**
 * Implements hook_cloudwords_refresh_translatables().
 */
function cloudwords_i18n_contact_cloudwords_refresh_translatables(&$context) {
  cloudwords_i18n_refresh_strings('contact', 'category', 'contact_category');
}
