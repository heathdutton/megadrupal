<?php

/**
 * Advertise the current views api version
 */
function content_callback_views_api_version() {
  return 2.0;
}

/**
 * Implementation of hook_views_plugins
 */
function content_callback_views_plugins() {
  return array(
    'display' => array(
      'content_callback' => array(
        'title' => t('Content callback'),
        'help' => t('Creates a display for content callbacks.'),
        'handler' => 'content_callback_plugin_display_content_callback',
        'theme' => 'views_view',
        'theme path' => drupal_get_path('module', 'views') . '/theme',
        'use ajax' => TRUE,
        'use pager' => TRUE,
        'use more' => TRUE,
        'accept attachments' => TRUE,
      ),
    ),
  );
}

/**
 * Callback function for content callback views content callbacks.
 * @param string $id
 */
function content_callback_views_content_callback_views_callback($entity, $display, $callback) {
  $view = views_get_view($callback['views_view_name']);
  $view->override_path = current_path();

  return array(
    '#markup' => $view->preview($callback['views_display_id']),
    'view_results' => views_get_view_result($callback['views_view_name'], $callback['views_display_id']),
  );
}
