<?php

/**
 * @file
 * Implementation of primary Drupal hooks.
 *
 * This is the main module file for Menu Management Languages.
 */

/**
 * Implements hook_form_FORM_ID_alter().
 *
 *  Add the language of each menu item next to it in the menu management
 * administration page.
 */
function menu_management_languages_form_menu_overview_form_alter(&$form, &$form_state, $form_id) {
  $languages = language_list();
  if (count($languages) > 1) {
    foreach ($form as $key => $value) {
      if (preg_match('/^mlid\:[0-9]+/', $key)) {
        // it's a menu item.
        $menu_item_language = $form[$key]['#item']['language'];
        if (array_key_exists($menu_item_language, $languages)) {
          $language = $languages[$menu_item_language];
          $language_name = t($language->name);
          $original_markup = $form[$key]['title']['#markup'];
          $new_markup = "$original_markup ($language_name)";
          $form[$key]['title']['#markup'] = $new_markup;
        }
      }
    }
  }
}
