<?php

/**
 * Implements hook_install().
 */
function openid_sso_provider_registration_install() {

  $email_token_help = t('Available variables are: [site:name], [site:url], [user:name], [user:mail], [site:login-url], [site:url-brief], [user:edit-url], [user:one-time-login-url], [user:cancel-url].');

  $field = array(
    'field_name' => 'override_standard_emails',
    'cardinality' => 1,
    'type' => 'list_boolean',
    'settings' => array(
      'allowed_values' => array(0 => 0, 1 => 1),
    ),
    'entity_types' => array('openid_sso_provider_rps'),
  );
  field_create_field($field);

  $instance = array(
    'entity_type' => 'openid_sso_provider_rps',
    'field_name' => 'override_standard_emails',
    'bundle' => 'openid_sso_provider_rps',
    'label' => t('Override standard email notification for users'),
    'widget_type' => 'options_onoff',
    'widget' => array(
      'type' => 'options_onoff',
      'settings' => array(
        'display_label' => 1,
      ),
    ),
  );
  field_create_instance($instance);

  $field = array(
    'field_name' => 'email_pending_approval',
    'type' => 'text_long',
    'entity_types' => array('openid_sso_provider_rps'),
    'translatable' => TRUE,
  );
  field_create_field($field);

  $instance = array(
    'entity_type' => 'openid_sso_provider_rps',
    'field_name' => 'email_pending_approval',
    'bundle' => 'openid_sso_provider_rps',
    'label' => 'Email pending approval',
    'description' => t('Edit the welcome e-mail messages sent to new members upon registering, when administrative approval is required.') . ' ' . $email_token_help,
    'widget_type' => 'text_textarea',
    'settings' => array('display_summary' => TRUE),
    'display' => array(
      'default' => array(
        'label' => 'hidden',
        'type' => 'text_default',
      ),
      'teaser' => array(
        'label' => 'hidden',
        'type' => 'text_default',
      ),
    ),
  );
  field_create_instance($instance);

  $field = array(
    'field_name' => 'email_activated',
    'type' => 'text_long',
    'entity_types' => array('openid_sso_provider_rps'),
    'translatable' => TRUE,
  );
  field_create_field($field);

  $instance = array(
    'entity_type' => 'openid_sso_provider_rps',
    'field_name' => 'email_activated',
    'bundle' => 'openid_sso_provider_rps',
    'label' => 'Email activated',
    'description' => t('Enable and edit e-mail messages sent to users upon account activation (when an administrator activates an account of a user who has already registered, on a site where administrative approval is required).') . ' ' . $email_token_help,
    'widget_type' => 'text_textarea',
    'settings' => array('display_summary' => TRUE),
    'display' => array(
      'default' => array(
        'label' => 'hidden',
        'type' => 'text_default',
      ),
      'teaser' => array(
        'label' => 'hidden',
        'type' => 'text_default',
      ),
    ),
  );
  field_create_instance($instance);

  $field = array(
    'field_name' => 'email_no_approval_required',
    'type' => 'text_long',
    'entity_types' => array('openid_sso_provider_rps'),
    'translatable' => TRUE,
  );
  field_create_field($field);

  $instance = array(
    'entity_type' => 'openid_sso_provider_rps',
    'field_name' => 'email_no_approval_required',
    'bundle' => 'openid_sso_provider_rps',
    'label' => 'Email no approval required',
    'description' => t('Edit the welcome e-mail messages sent to new members upon registering, when no administrator approval is required.') . ' ' . $email_token_help,
    'widget_type' => 'text_textarea',
    'settings' => array('display_summary' => TRUE),
    'display' => array(
      'default' => array(
        'label' => 'hidden',
        'type' => 'text_default',
      ),
      'teaser' => array(
        'label' => 'hidden',
        'type' => 'text_default',
      ),
    ),
  );
  field_create_instance($instance);
}


/**
 * Implements hook_uninstall().
 */
function openid_sso_provider_registration_uninstall() {

  field_delete_instance(array(
    'field_name' => 'override_standard_emails',
    'bundle' => 'openid_sso_provider_rps',
    'entity_type' => 'openid_sso_provider_rps',
  ));

  field_delete_instance(array(
    'field_name' => 'email_pending_approval',
    'bundle' => 'openid_sso_provider_rps',
    'entity_type' => 'openid_sso_provider_rps',
  ));
  field_delete_instance(array(
    'field_name' => 'email_pending_approval',
    'bundle' => 'openid_sso_provider_rps',
    'entity_type' => 'openid_sso_provider_rps',
  ));
  field_delete_instance(array(
    'field_name' => 'email_activated',
    'bundle' => 'openid_sso_provider_rps',
    'entity_type' => 'openid_sso_provider_rps',
  ));

  field_delete_instance(array(
    'field_name' => 'email_no_approval_required',
    'bundle' => 'openid_sso_provider_rps',
    'entity_type' => 'openid_sso_provider_rps',
  ));

}
