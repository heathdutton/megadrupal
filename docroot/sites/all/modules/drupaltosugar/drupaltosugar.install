<?php

/**
 * @file
 * Schema and uninstall functions for the drupaltosugar module.
 */

/**
 * Implements of hook_uninstall().
 */
function drupaltosugar_uninstall() {
  $system_var = array(
    // URL of the SOAP service endpoint.
    'drupaltosugar_sugarcrm_url',
    // Username for login to Sugarcrm.
    'drupaltosugar_sugarcrm_username',
    // Password for login to Sugarcrm.
    'drupaltosugar_sugarcrm_pass',
  );
  // Remove module defined system_variables.
  foreach ($system_var as $var_name) {
    variable_del($var_name);
  }
}

/**
 * Implements of hook_schema().
 */
function drupaltosugar_schema() {
  $schema['drupaltosugar'] = array(
    'description' => 'This table stores the mapping of webform and sugarcrm fields.',
    'fields' => array(
      'id' => array(
        'type' => 'serial',
        'not null' => TRUE,
        'description' => 'drupaltosugar mapping id',
      ),
      'wnid' => array(
        'type' => 'int',
        'not null' => TRUE,
        'description' => 'webform nid',
      ),
      'uid' => array(
        'type' => 'int',
        'not null' => TRUE,
        'description' => 'user id',
      ),
      'wcid' => array(
        'type' => 'int',
        'not null' => TRUE,
        'description' => 'webform component id',
      ),
      'w_field_name' => array(
        'type' => 'varchar',
        'length' => 50,
        'not null' => TRUE,
        'description' => 'webform fields name',
      ),
      'crm_field_name' => array(
        'type' => 'varchar',
        'length' => 50,
        'not null' => FALSE,
        'default' => NULL,
        'description' => 'sugarcrm fields name',
      ),
      'crm_module' => array(
        'type' => 'varchar',
        'length' => 50,
        'not null' => TRUE,
        'description' => 'sugarcrm module name',
      ),
      'crm_related_module' => array(
        'type' => 'varchar',
        'length' => 50,
        'not null' => FALSE,
        'default' => NULL,
        'description' => 'sugarcrm related module name',
      ),
      'crm_default_value' => array(
        'type' => 'varchar',
        'length' => 50,
        'not null' => FALSE,
        'default' => 0,
        'description' => 'sugarcrm related module name',
      ),
      'crm_field_type' => array(
        'type' => 'varchar',
        'length' => 50,
        'not null' => FALSE,
        'default' => NULL,
        'description' => 'sugarcrm field datatype',
      ),
    ),
    'primary key' => array('id'),
  );

  $schema['drupaltosugar_data'] = array(
    'description' => 'This table stores the webform submited to sugarcrm.',
    'fields' => array(
      'id' => array(
        'type' => 'serial',
        'not null' => TRUE,
        'description' => 'drupaltosugar mapping id',
      ),
      'wnid' => array(
        'type' => 'int',
        'not null' => TRUE,
        'description' => 'webform nid',
      ),
      'wsid' => array(
        'type' => 'int',
        'not null' => TRUE,
        'description' => 'webform submission id',
      ),
      'crm_rid' => array(
        'type' => 'varchar',
        'length' => 50,
        'not null' => TRUE,
        'description' => 'sugarcrm record id',
      ),
      'status' => array(
        'type' => 'int',
        'size' => 'tiny',
        'not null' => TRUE,
        'default' => 0,
        'description' => 'webform submit status',
      ),
      'error' => array(
        'type' => 'varchar',
        'length' => 255,
        'not null' => FALSE,
        'description' => 'any error while saving webfrom to sugarcrm',
      ),
      'attempt' => array(
        'type' => 'int',
        'not null' => TRUE,
        'default' => 0,
        'description' => 'number of attempt to save webform to sugarcrm',
      ),
      'created' => array(
        'type' => 'int',
        'not null' => FALSE,
        'description' => 'webform created date',
      ),
      'updated' => array(
        'type' => 'int',
        'not null' => FALSE,
        'description' => 'webform updated time',
      ),
    ),
    'primary key' => array('id'),
  );

  return $schema;
}
