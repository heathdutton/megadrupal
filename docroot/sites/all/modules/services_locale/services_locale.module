<?php

/**
 * @file
 * services_locale.module
 */

/**
 * Implements hook_permission().
 */
function services_locale_permission() {
  return array(
    'services locale return countries' => array(
      'title' => t('Return country list'),
    ),
    'services locale return languages' => array(
      'title' => t('Return language list'),
    ),
  );
}

/**
 * Implements hook_services_resources().
 */
function services_locale_services_resources() {
  return array(
    'locale_countries' => array(
      'index' => array(
        'help' => 'Return list of countries.',
        'file' => array(
          'type' => 'inc',
          'module' => 'services_locale',
          'name' => 'services_locale.resource'
        ),
        'callback' => 'services_locale_countries',
        'access callback' => '_services_locale_country_access',
        'access arguments' => array('view'),
        'access arguments append' => TRUE
      )
    ),
    'locale_languages' => array(
      'index' => array(
        'help' => 'Return list of languages.',
        'file' => array(
          'type' => 'inc',
          'module' => 'services_locale',
          'name' => 'services_locale.resource'
        ),
        'callback' => 'services_locale_languages',
        'access callback' => '_services_locale_language_access',
        'access arguments' => array('view'),
        'access arguments append' => TRUE
      )
    )
  );
}

/**
 * Locale language access callback.
 */
function _services_locale_country_access($op = 'view', $args = array()) {
  $access = FALSE;

  if ($op == 'view') {
    $access = user_access('services locale return countries');
  }

  return $access;
}

/**
 * Locale country access callback.
 */
function _services_locale_language_access($op = 'view', $args = array()) {
  $access = FALSE;

  if ($op == 'view') {
    $access = user_access('services locale return languages');
  }

  return $access;
}
