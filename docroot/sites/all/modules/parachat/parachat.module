<?php

/**
 * @file
 * Parachat Integration Module
 *
 * This module handles embedding a Parachat applet in your site. All that needs
 * to be done is configure the Parachat site config and it should be good to go.
 */

/**
 * Implementation of hook_perm().
 */
function parachat_permission() {
  return array(
    'access chat' => array(
      'title' => t('Access Chat'),
      'description' => t('Allow user to access the chat room.'),
    ),
    'administer chat' => array(
      'title' => t('Administer Chat'),
      'description' => t('Allow user to administer the chat room.'),
    ),
  );
}

/**
 * Implementation of hook_menu().
 */
function parachat_menu() {

  // page with chat room embedded in it
  $items['chat'] = array(
    'title' => 'Member Chat',
    'page callback' => 'parachat_page',
    'access arguments' => array('access chat'),
    'type' => MENU_NORMAL_ITEM,
    'weight' => -9,
    'file' => 'parachat.pages.inc',
  );

  // page used for parachat to authenticate back with the server
  $items['chat/auth'] = array(
    'page callback' => 'parachat_auth_page',
    'access callback' => TRUE,
    'type' => MENU_CALLBACK,
    'file' => 'parachat.pages.inc',
  );

  // admin settings page
  $items['admin/config/parachat'] = array(
    'title' => t('Parachat Settings'),
    'descriptions' => t('Setup Parachat'),
    'page callback' => 'drupal_get_form',
    'page arguments' => array('parachat_admin_settings'),
    'access arguments' => array('administer site configuration'),
    'type' => MENU_NORMAL_ITEM,
    'file' => 'parachat.admin.inc'
    );

  return $items;
}

/**
 * Implementation of hook_theme()
 */
function parachat_theme() {
  return array(
    'parachat' => array(
      'variables' => array(
        'codebase' => NULL,
        'width' => 750,
        'height' => 500,
        'site_id' => NULL,
        'room' => NULL,
        'username' => t('anonymous'),
        'pass' => FALSE,
      ),
      'template' => 'parachat-applet',
      'type' => 'module',
      'theme_path' => drupal_get_path('module', 'parachat')
    ),
  );
}