<?php

/**
 * Implements hook_wm_item().
 */
function wm_contents_wm_item() {
  $images = drupal_get_path('module', 'wm_contents') . '/images/';

  $items['content'] = array(
    '#title' => t('Content'),
    '#class' => array(),
    '#weigth' => 0,
    '#icon' => $images . 'contents.png',
    '#items' => array(
      'contents' => array(
        'title' => t('Contents'),
        'href' => 'admin/content',
        'help' => t('View all contents'),
        'shortcut' => TRUE,
      ),
    ),
  );

  if (module_exists('workbench')) {
    $items['content']['#items']['contents']['href'] = 'admin/workbench/content/all';
  }

  $items['content']['#items'] = array_merge($items['content']['#items'], _wm_contents_get_content());

  return $items;
}

function _wm_contents_get_content() {
  $images = drupal_get_path('module', 'wm_contents') . '/images/';
  $types = node_type_get_types();

  $contents = array();
  foreach ($types as $key => $type) {
    if (node_access('create', $type->type)) {
      $contents['create-' . $key] = array(
        'icon' => $images . 'document--plus.png',
        'title' => t('New !type', array('!type' => $type->name)),
        'href' => 'node/add/' . strtr($type->type, '_', '-'),
        'help' => t('Create a new !type', array('!type' => $type->name)),
        'shortcut' => TRUE,
      );
    }
  }

  return $contents;
}
