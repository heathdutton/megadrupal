<?php
/**
 * @file
 * The example magic form module.
 */

/**
 * Implements hook_menu().
 */
function magic_forms_example_menu() {
  $items = array();

  $items[MAGIC_FORMS_BASE_PATH . '/example'] = array(
    'title' => 'Example form',
    'description' => 'An example form showing off magic forms.',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('magic_forms_example_form'),
    'access arguments' => array(MAGIC_FORMS_PERMISSION),
    'type' => MENU_LOCAL_TASK,
  );

  return $items;
}

/**
 * The example form callback.
 */
function magic_forms_example_form($form, &$form_state) {
  $form = array();

  $form['#magic-forms'] = array();

  $form['email'] = array(
    '#type' => 'textfield',
    '#title' => t('Email address'),
    '#description' => t('Validates an email address.'),
    '#required' => TRUE,
    '#magic-forms' => array(
      'validators' => array(
        array(
          'type' => 'email',
          'message' => t('You have entered an invalid email address.'),
        ),
      ),
    ),
  );

  $form['website'] = array(
    '#type' => 'textfield',
    '#title' => t('Website'),
    '#description' => t('Validates a website address.'),
    '#magic-forms' => array(
      'validators' => array(
        array(
          'type' => 'url',
          'message' => t('You have entered an invalid website.'),
        ),
        array(
          'type' => 'url-domain',
          'message' => t('The website domain must be google.com or google.co.uk.'),
          'config' => array(
            'schemes' => array('http', 'https'),
            'domains' => array('google.*'),
          ),
        ),
      ),
    ),
  );

  $form['numeric_group'] = array(
    '#type' => 'fieldset',
    '#title' => t('Numeric fields'),
    '#collapsed' => TRUE,
  );

  $form['numeric_group']['integer'] = array(
    '#type' => 'textfield',
    '#title' => t('Integer'),
    '#description' => t('Validates an integer value between 0 and 10.'),
    '#required' => TRUE,
    '#min' => 0,
    '#max' => 10,
    '#magic-forms' => array(
      'required-error' => t('You must enter a valid integer value between 0 and 10.'),
      'validators' => array(
        array(
          'type' => 'number',
          'message' => t('You have entered an invalid integer, it must be between 0 and 10.'),
          'config' => array(
            'min' => 0,
            'max' => 10,
          ),
        ),
      ),
      'placeholder' => t('Enter an integer between 0 and 10.'),
    ),
  );

  $form['actions'] = array('#type' => 'actions');
  $form['actions']['submit'] = array(
    '#type' => 'submit',
    '#value' => t('Submit form'),
  );

  return $form;
}
