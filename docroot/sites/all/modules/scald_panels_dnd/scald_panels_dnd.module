<?php

/**
 * @file
 * Allows Scald drag and drop to be enabled in Panels.
 */

/**
 * Implements hook_form_FORM_ID_alter().
 * Add dnd and css for ALL panels 'custom content' ctools forms.
 */
function scald_panels_dnd_form_ctools_custom_content_type_edit_form_alter(&$form, &$form_state) {
  $form['scald_panels']['#attached'] = array();
  scald_panels_dnd_attach_css($form);
  scald_panels_dnd_attach_dnd($form);
}

/**
 * Implements hook_form_FORM_ID_alter().
 * Add dnd to custom content pane form.
 */
function scald_panels_dnd_form_ctools_export_ui_edit_item_form_alter(&$form, &$form_state) {
  $form['scald_panels']['#attached'] = array();
  scald_panels_dnd_attach_dnd($form);
}

/**
 * Attach Scald dnd library to Drupal form.
 */
function scald_panels_dnd_attach_dnd(&$form) {
  $form['scald_panels']['#attached']['library'] = array(array('dnd', 'library'));
}

/**
 * Attach css to ensure Scald dnd library is above panel overlay.
 */
function scald_panels_dnd_attach_css(&$form) {
  $form['scald_panels']['#attached']['css'] = array(drupal_get_path('module', 'scald_panels_dnd') . '/scald_panels_dnd.css');
}