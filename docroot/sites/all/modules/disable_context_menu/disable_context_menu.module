<?php

/**
 * @file
 * Main file of Disable Context Menu module.
 */

/**
 * Implements hook_permission().
 */
function disable_context_menu_permission() {
  return array(
    'bypass disabled context menu' => array(
      'title' => t('Bypass disabled context menu'),
      'description' => t("Allows the user to use the context menu even if it's blocked."),
    ),
    'administer disable context menu' => array(
      'title' => t('Administer Disable Context Menu'),
      'description' => t('Perform administration tasks for Disable Context Menu module.'),
    ),
  );
}

/**
 * Implements hook_menu().
 */
function disable_context_menu_menu() {
  $items['admin/config/user-interface/disable-context'] = array(
    'title' => 'Disable Context Menu',
    'description' => 'Administer how context menus are blocked.',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('disable_context_menu_settings'),
    'access arguments' => array('administer disable context menu'),
    'type' => MENU_NORMAL_ITEM,
    'file' => 'disable_context_menu.admin.inc',
  );
  return $items;
}

/**
 * Implements hook_init().
 */
function disable_context_menu_init() {
  if (!user_access('bypass disabled context menu')) {
    // Adding the settings to the Drupal settings object.
    $settings = array(
      'disableContextMenu' => array(
        'selectors' => variable_get('disable_context_menu_selectors', 'img, audio, video'),
        'message' => variable_get('disable_context_menu_message', ''),
      ),
    );

    // Adding the necessary javascript file.
    drupal_add_js($settings, 'setting');
    drupal_add_js(drupal_get_path('module', 'disable_context_menu') . '/disable_context_menu.js');
  }
}
