<?php

/**
 * hook_module_plugin()
 *
 * Automatically created by CTools for every plugin defined.
 *
 * Another plugin will be defined here:
 * 1) Commerce_product references which is a part of the entity references
 *
 * Basically the variation types for each commerce kickstart content type.
 */
function good_relations_commerce_product_good_relations_product() {
  $commerce_product = _good_relations_commerce_product_load();

  // Plugin structure respected for the commerce product bundles.
  $configured_commerce_bundles = array();

  foreach ($commerce_product as $machine_name => $value) {
    $configured_commerce_bundles = array_merge($configured_commerce_bundles, array(
      $machine_name => array(
        'label' => $value['label'],
        'handler' => array(
          'class' => 'good_relations_commerce_product',
        ),
      ),
    ));
  }
  $configured_commerce_bundles['entity'] = 'commerce_product';
  $configured_commerce_bundles['label'] = 'Commerce products';
  $plugins = array(
    'commerce_products' => $configured_commerce_bundles,
  );

  return $plugins;
}

/**
 * Load all of the variation types defined in the database.
 *
 * @return mixed
 */
function _good_relations_commerce_product_load() {
  $commerce_products = entity_get_info('commerce_product');
  if (isset($commerce_products['bundles'])) {
    return $commerce_products['bundles'];
  }
  else {
    return array();
  }
}
