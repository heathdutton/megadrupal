<?php

/**
 * Implements hook_block_info().
 *
 * @return array
 */
function civimenu_block_info() {
  return array('civimenu' => array(
    'info' => t('CiviCRM Menu'),
    'visibility' => BLOCK_VISIBILITY_NOTLISTED,
    'region' => 'content',
    'pages' => 'civicrm*',
    'status' => 1,
    'properties' => array('administrative' => TRUE),
    'cache' => DRUPAL_NO_CACHE,
  ));
}

/**
 * Implements hook_block_view().
 *
 * @param string $delta
 *
 * @return array
 */
function civimenu_block_view($delta = '') {
  if ($delta == 'civimenu') {
    civicrm_initialize();
    CRM_Core_Resources::singleton()->addCoreResources();
    require_once 'CRM/Core/Smarty/plugins/function.crmNavigationMenu.php';
    $params = array();
    drupal_add_region_content('content', smarty_function_crmNavigationMenu($params, $params));
  }
  return array();
}
