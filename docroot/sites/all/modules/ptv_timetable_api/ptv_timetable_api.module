<?php
/**
 * @file
 * This module provides third-party integration for Australia PTV time table.
 */

// Defines API endpoints.
define('PTV_TIMETABLE_API_SIGNATURE_HASH_METHOD', 'sha1');
define('PTV_TIMETABLE_API_BASE_URL', 'http://timetableapi.ptv.vic.gov.au');
define('PTV_TIMETABLE_API_HEALTH_CHECK', '/v2/healthcheck');
define('PTV_TIMETABLE_API_STOPS_NEARBY', '/v2/nearme/latitude/@lat/longitude/@long');
define('PTV_TIMETABLE_API_POI', '/v2/poi/@poi/lat1/@lat1/long1/@long1/lat2/@lat2/long2/@long2/griddepth/@griddepth/limit/@limit');
define('PTV_TIMETABLE_API_SEARCH', '/v2/search/@search');
define('PTV_TIMETABLE_API_BROAD_NEXT_DEPARTURES', '/v2/mode/@mode/stop/@stop/departures/by-destination/limit/@limit');
define('PTV_TIMETABLE_API_SPECIFIC_NEXT_DEPARTURES', '/v2/mode/@mode/line/@line/stop/@stop/directionid/@direction/departures/all/limit/@limit');
define('PTV_TIMETABLE_API_STOPPING_PATTERN', '/v2/mode/@mode/run/@run/stop/@stop/stopping-pattern');
define('PTV_TIMETABLE_API_LINE_STOPS', '/v2/mode/@mode/line/@line/stops-for-line');
define('PTV_TIMETABLE_API_LINES', '/v2/lines/mode/@mode');
define('PTV_TIMETABLE_API_DISRUPTIONS', '/v2/disruptions/modes/@modes');

// Defines types of points of interest.
define('PTV_TIMETABLE_API_TYPE_TRAIN', 0);
define('PTV_TIMETABLE_API_TYPE_TRAM', 1);
define('PTV_TIMETABLE_API_TYPE_BUS', 2);
define('PTV_TIMETABLE_API_TYPE_VLINE', 3);
define('PTV_TIMETABLE_API_TYPE_NIGHTRIDER', 4);
define('PTV_TIMETABLE_API_TYPE_TICKET_OUTLET', 100);

// Define POI grid depth range.
define('PTV_TIMETABLE_API_MIN_POI_GRID_DEPTH', 0);
define('PTV_TIMETABLE_API_MAX_POI_GRID_DEPTH', 20);

// Define modes of transport.
define('PTV_TIMETABLE_API_TRANSPORT_GENERAL', 'general');
define('PTV_TIMETABLE_API_TRANSPORT_METRO_BUS', 'metro-bus');
define('PTV_TIMETABLE_API_TRANSPORT_METRO_TRAIN', 'metro-train');
define('PTV_TIMETABLE_API_TRANSPORT_METRO_TRAM', 'metro-tram');
define('PTV_TIMETABLE_API_TRANSPROT_REGIONAL_BUS', 'regional-bus');
define('PTV_TIMETABLE_API_TRANSPROT_REGIONAL_COACH', 'regional-coach');
define('PTV_TIMETABLE_API_TRANSPROT_REGIONAL_TRAIN', 'regional-train');

/**
 * Implements hook_menu().
 */
function ptv_timetable_api_menu() {

  $items = array();

  $items['admin/config/system/ptv-timetable-api'] = array(
    'title' => 'PTV Timetable API',
    'description' => 'Administer PTV timetable API',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('ptv_timetable_api_settings_form'),
    'access arguments' => array('administer ptv timetable api'),
    'file' => 'ptv_timetable_api.admin.inc',
  );

  return $items;
}

/**
 * Implements hook_permission().
 */
function ptv_timetable_api_permission() {
  return array(
    'administer ptv timetable api' => array(
      'title' => t('Administer PTV timetable API'),
      'description' => t('Perform administration tasks for PTV timetable API.'),
    ),
  );
}
