<?php

/**
 * @file
 * Install file for shared_access module.
 */


/**
 * Implements hook_field_schema().
 *
 * Defines the database schema of the shared_access field. The schema contains
 * the following columns:
 *
 * - gid: The grant id. These will be the ids associated with the user or
 *        group that is granted access through the shared_access field's
          access settings form.
 *
 * - op: The operation being granted. The possible values are configurable
 *       through a bundle's manage fields administration in the field's
 *       field instance settings. The defaults are the usual 'view', 'update',
 *       'delete'.
 *
 * - realm: Is related to the type of entity being granted the access. For
 *          example 'user' or 'group', but in theory it could be any entity
 *          or really any string if another module wants to hook in and control
 *          it.
 *
 *
 * @see http://drupal.org/node/146939
 * @see schemaapi
 * @see hook_field_schema()
 */
function shared_access_field_schema($field) {
  if ($field['type'] == 'shared_access') {
    $columns = array(
      // text to store the realm to which this grant belongs. This could be
      // anything, but is intended to identify the entity type access is being
      // granted to.
      'realm' => array(
        'type' => 'varchar',
        'length' => 255,
        'not null' => TRUE,
        'description' => 'The grant realm to match with the grant id.',
      ),
      // integer to store the grant id.
      'gid' => array(
        'type' => 'int',
        'not null' => TRUE,
        'description' => 'The grant id to compare against the realm.',
      ),
      // optional: string to store extra access info aside from a gid.
      'gstr' => array(
        'type' => 'varchar',
        'length' => 255,
        'description' => 'Optional: Grant string to compare against the realm.',
      ),
      // text to store operation being granted.
      'op' => array(
        'type' => 'varchar',
        'length' => 32,
        'not null' => TRUE,
        'description' => 'The operation being granted for this particular entity. The possible values are defined in the field settings.',
      ),
    );
    return array(
      'columns' => $columns,
      'indexes' => array(
        'realm' => array('realm'),
        'gid' => array('gid'),
      ),
    );
  }
}
