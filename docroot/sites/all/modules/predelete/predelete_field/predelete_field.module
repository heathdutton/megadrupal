<?php
/**
 * @file
 * Code for the predelete_field feature.
 */

include_once('predelete_field.features.inc');

/**
 * Implements hook_predelete_node().
 */
function predelete_field_predelete_node($node) {
  // Is there a field on that node?
  $value = field_get_items('node', $node, 'field_deletabel');
  if (is_array($value)) {
    // There is a field and its value controlls the result
    $deletable = $value[0]['value'] == 1;
    $reason = t('The content of the deletable field on the node is set to !value', array('!value' => $value[0]['value']));
  } else {
    // The node does not contain the field, so it is deletable by default.
    $deletable = TRUE;
    $reason = t('The node does not containg the field field_deletable');
  }

  return array('result' => $deletable, 'reason' => $reason);
}
