<?php

/**
 * @file
 * Install, update and uninstall functions for the walkthru module.
 */

/**
 * Implements hook_schema().
 */
function walkthru_schema() {
    $schema['walkthru'] = array(
    'description' => 'Contains walkthru information.',
    'fields' => array(
      'name' => array(
        'type' => 'varchar',
        'length' => '255',
        'description' => 'Unique ID for this guider-set. Used to identify it programmatically.',
        'not null' => TRUE,
      ),
      'title' => array(
        'type' => 'varchar',
        'length' => '255',
        'description' => 'Visual title for this guider-set.',
        'not null' => TRUE,
      ),
    ),
    'primary key' => array('name'),
  );

  $schema['walkthru_steps'] = array(
    'description' => 'Contains steps in a walkthru.',
    'fields' => array(
      'walkthru_name' => array(
        'type' => 'varchar',
        'length' => '255',
        'not null' => TRUE,
        'description' => 'The walkthru unique ID',
        'no export' => TRUE,
      ),
      'name' => array(
        'type' => 'varchar',
        'length' => '255',
        'description' => 'Unique ID for this step. Used to identify it programmatically.',
        'not null' => TRUE,
      ),
      'title' => array(
        'type' => 'varchar',
        'length' => '255',
        'description' => 'Visual title for this step.',
        'not null' => TRUE,
      ),
      'weight' => array(
        'type' => 'int',
        'not null' => TRUE,
        'description' => 'The step\'s weight',
      ),
      'data' => array(
        'type' => 'text',
        'size' => 'big',
        'description' => 'A full step data',
        'serialize' => TRUE,
        'object default' => array(),
      ),
    ),
    'primary key' => array('name'),
    'indexes' => array(
      'id' => array('name', 'walkthru_name'),
    ),
    'foreign keys' => array(
      'walkthru' => array(
        'table' => 'walkthru',
        'columns' => array('walkthru_name' => 'name'),
      ),
    ),
  );

  $schema['cache_walkthru'] = drupal_get_schema_unprocessed('system', 'cache');
  $schema['cache_walkthru']['description'] = t('Cache table for the walkthru module to store already processed and cached js code.');

  return $schema;
}
