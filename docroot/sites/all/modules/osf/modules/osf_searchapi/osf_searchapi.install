<?php

/**
 * Implements hook_install().
 */
function osf_searchapi_install() {
  if (module_exists('search_api')) {

    module_load_include('inc', 'search_api', 'search_api.admin');

    $form_id = 'search_api_admin_add_server';
    $form_state = array(
      'values' => array(
        'name' => t('Default OSF Service'),
        'machine_name' => 'default_osf_web_services_service',
        'enabled' => 1,
        'description' => '',
        'class' => 'osf_searchapi_service',
        'options' => array(
          'form' => array('network' => 'http://localhost/ws/'),
          'class' => 'osf_searchapi_service',
        ),
        'op' => 'Create server',
      ),
    );

    drupal_form_submit($form_id, $form_state);

    $index_form_id = 'search_api_admin_add_index';

    $index_form_state = array(
      'values' => array(
        'name' => t('Default OSF Index'),
        'machine_name' => 'default_osf_web_services_index',
        'item_type' => 'node',
        'enabled' => 1,
        'description' => '',
        'server' => 'default_osf_web_services_service',
        'read_only' => 0,
        'options' => array(
          'index_directly' => 0,
          'cron_limit' => '50',
        ),
      ),
    );

    drupal_form_submit($index_form_id, $index_form_state);
  }
}
