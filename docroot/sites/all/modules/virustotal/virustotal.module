<?php
/**
 * @file
 * Provides VirusTotal API functionality
 *
 * Contains configuration functionality for VirusTotal API.
 */

/**
 * Implements hook_menu().
 */
function virustotal_menu() {
  $items['admin/config/system/virustotal'] = array(
    'title' => 'VirusTotal',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('virustotal_admin_configuration_form'),
    'access arguments' => array('administer site configuration'),
  );
  return $items;
}

/**
 * Form callback for administrative configuration.
 */
function virustotal_admin_configuration_form($form, &$form_state) {

  // Textfield input for VT API Key.
  $form['virustotal_api_key'] = array(
    '#type' => 'textfield',
    '#title' => t('API Key'),
    '#description' => t("Once you have a valid VirusTotal Community account, you will find your personal API key on the profile of your account (sign in and click on the API key tab). This key is all you need to use VirusTotal's API."),
    '#default_value' => variable_get('virustotal_api_key', ''),
    '#required' => TRUE,
    '#weight' => 0,
  );

  return system_settings_form($form);
}
