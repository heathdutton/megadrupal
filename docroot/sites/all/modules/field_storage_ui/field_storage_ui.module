<?php

/**
 * @file
 * Field Storage UI main module file.
 */

/**
 * Implements hook_form_FORM_ID_alter().
 */
function field_storage_ui_form_field_ui_field_overview_form_alter(&$form, &$form_state, $id) {
  form_load_include($form_state, 'inc', 'field_storage_ui', 'field_storage_ui.admin');
  _field_storage_ui_form_field_ui_field_overview_form_alter($form);
}

/**
 * Implements hook_menu().
 */
function field_storage_ui_menu() {
  $items = array();
  $items['admin/reports/fields/default-storage'] = array(
    'title' => 'Field default storage',
    'description' => 'Set the default field storage.',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('field_storage_ui_field_storage_default_form'),
    'type' => MENU_LOCAL_TASK,
    'weight' => -1,
    'access arguments' => array('administer content types'),
    'file' => 'field_storage_ui.admin.inc',
  );

  return $items;
}

/**
 * Implements hook_menu_alter().
 *
 * Alter the field list overvew adding our own page callback.
 *
 * @see field_ui_menu()
 */
function field_storage_ui_menu_alter(&$items) {
  if (isset($items['admin/reports/fields'])) {
    $items['admin/reports/fields']['page callback'] = 'field_storage_ui_fields_list';
  }
}

/**
 * Menu callback; lists all defined fields including storage information.
 *
 * @see field_ui_fields_list()
 */
function field_storage_ui_fields_list() {
  module_load_include('inc', 'field_storage_ui', 'field_storage_ui.admin');
  return _field_storage_ui_fields_list();
}
