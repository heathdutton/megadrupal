<?php

function _genosha_get_config( $index ) {
  $config = array(
    'genosha' => array(
      'label' => t( 'Genosha' ),
      'currencies' => array(
        'USD' => "United States Dollar",
        'EUR' => "Euro",
      ),
      'official_bank' => array(
        'currencies' => array(
          'USD' => array( ),
          'EUR' => array( ),
        ),
        'label' => 'Genosha Bank'
      ),
      'banks' => array()
    )
  );


  if ( !isset( $index ) ) {
    return $config;
  }
  else {
    return $config[ 'genosha' ][ $index ];
  }
}

/**
 * implement hook_exchange_rate_get_config 
 */
function genosha_exchange_rate_get_config($country,$index = null) {
 if($country == 'genosha') { 
  return _genosha_get_config( $index);
 }
}

/**
 * implement hook_exchange_rate_country_info
 */
function genosha_exchange_rate_country_info() {

  return _genosha_get_config(null);
}

function genosha_exchange_rate_name( $name ) {
  if ( $name == 'genosha' ) {
    return t( "Genosha" );
  }
}

/**
 * Implementation of hook_cron
 */
function genosha_cron() {
  //Enable each module i.e Genosha can be executed isolate , useful with elysia cron module
  genosha_exchange_rate_cron();
}

function genosha_exchange_rate_cron() {
  $buy = rand( 500, 600 );
  $sell = $buy + rand( 1, 10 ) * $buy / 100;

  //Insert record in exchage_record historical
  $record = array(
    "country" => 'genosha',
    "bank" => 'Genosha Bank',
    "currency" => 'USD',
    "date" => time(),
    "buy" => $buy,
    "sell" => $sell,
  );

  $buy = rand( 400, 450 );
  $sell = $buy + rand( 1, 10 ) * $buy / 100;
  drupal_write_record( 'exchange_rate_historical', $record );

  //Insert record in exchage_record historical
  $record = array(
    "country" => 'genosha',
    "bank" => 'Genosha Bank',
    "currency" => 'EUR',
    "date" => time(),
    "buy" => $buy,
    "sell" => $sell,
  );

  drupal_write_record( 'exchange_rate_historical', $record );
  //End insert record
}
