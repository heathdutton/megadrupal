<?php
// $Id: almanac.install,v 1.3 2011/02/18 09:58:03 nhwebworker Exp $

/**
 * @file
 * Standard installation functions.
 */

/**
 * Implements hook_install().
 */
function almanac_install() {
  drupal_set_message(l(st('Almanac settings are available under Administer > Site configuration > Almanac'), 'admin/config/almanac')
    );
  // Set the date formats, taking care not to overwrite existing values.
  variable_set('date_format_time', variable_get('date_format_time', 'g:i a'));
  variable_set('date_format_short_date', variable_get('date_format_short_date', 'd M'));
}

/**
 * Implements hook_uninstall().
 */
function almanac_uninstall() {
  // Clean up the old variables.
  variable_del('almanac_locationname');
  variable_del('almanac_latitude');
  variable_del('almanac_longitude');
  variable_del('almanac_zoneoffset');
  variable_del('almanac_timestring');
  variable_del('almanac');
}

/**
 * Move the almanac variables into a singular array.
 */
function almanac_update_7000() {
  // Set the date formats, taking care not to overwrite existing values.
  switch (variable_get('almanac_timestring', 1)) {
    case 0:
      $timestring = 'H:i';

    case 2:
      $timestring = 'g:i A';

    default:
    case 1:
      $timestring = 'g:i a';

  }
  variable_set('date_format_time', variable_get('date_format_time', $timestring));
  variable_set('date_format_short_date', variable_get('date_format_short_date', 'd M'));

  $settings = almanac_settings();
  $settings['location']['name'] = variable_get('almanac_locationname', 'Bucuresti');
  $settings['location']['latitude'] = variable_get('almanac_latitude', 44.4325);
  $settings['location']['longitude'] = variable_get('almanac_longitude', -26.103889);
  $settings['location']['timezone'] = variable_get('almanac_zoneoffset', date_default_timezone_get());
  variable_set('almanac', $settings);

  // Clean up the old variables.
  variable_del('almanac_locationname');
  variable_del('almanac_latitude');
  variable_del('almanac_longitude');
  variable_del('almanac_zoneoffset');
  variable_del('almanac_timestring');

  // TODO: insert the cuustom format Edit  Delete  45  g:i a   custom  0


}



