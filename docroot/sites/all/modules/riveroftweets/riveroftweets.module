<?php

function riveroftweets() {
  $module_path = drupal_get_path('module', 'riveroftweets');

  drupal_add_js($module_path . '/riveroftweets.jquery.js');
  drupal_add_js(array('riveroftweets' => array('username' => variable_get('riveroftweets_username'),
                                             'template' => variable_get('riveroftweets_template'),
                                             'avatar' => variable_get('riveroftweets_avatar'),
                                             'count' => variable_get('riveroftweets_count'),
                                             'list' => variable_get('riveroftweets_list'),
                                             'query' => variable_get('riveroftweets_query'),
                                             'joindefault' => variable_get('riveroftweets_joindefault'),
                                             'joinded' => variable_get('riveroftweets_joined'),
                                             'joinding' => variable_get('riveroftweets_joining'),
                                             'joinreply' => variable_get('riveroftweets_joinreply'),
                                             'joinurl' => variable_get('riveroftweets_joinurl'),
                                             'refresh' => variable_get('riveroftweets_refresh'))
                     ), 'setting');
  drupal_add_js($module_path . '/riveroftweets.js');
  
  $content = "<div class='riveroftweets'></div>";
  
  return $content;
}

/**
 * Implementation of hook_menu().
 */

function riveroftweets_menu() {
  $items = array();

  $items['riveroftweets'] = array(
    'title' => t('River of Tweets'),
    'page callback' => 'riveroftweets',
    'access arguments' => array('access content'),
    'type' => MENU_CALLBACK,
   );
   
   $items['admin/config/riveroftweets'] = array(
    'title' => 'River of Tweets',
    'description' => 'My Description',
    'position' => 'left',
    'weight' => -5,
    'page callback' => 'system_admin_menu_block_page',
    'access arguments' => array('administer site configuration'),
    'file' => 'system.admin.inc',
    'file path' => drupal_get_path('module', 'system'),
  );
   
  $items['admin/config/riveroftweets/settings'] = array(
    'title' => 'River of Tweets settings',
    'description' => 'Settings for River of Tweets',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('riveroftweets_admin_settings'),
    'access arguments' => array('administer site configuration'),
    'type' => MENU_NORMAL_ITEM,
    'file' => 'riveroftweets.admin.inc',
  );
  
  return $items;  
}

/**
 * Implementation of hook_block_info().
 */

function riveroftweets_block_info() {
  $blocks['riveroftweets'] = array(
    'info' => t('River of Tweets'), //The name that will appear in the block list.
    'cache' => DRUPAL_CACHE_GLOBAL, //Default
  );
  return $blocks;
}

/**
 * Implementation of hook_block_view().
 */
function riveroftweets_block_view($delta='') {
  $block = array();
  switch ($delta) {
    case 'riveroftweets':
      $block['subject'] = t('River of Tweets');
      $block['content'] = riveroftweets();
      break;
  }
  return $block;
}
