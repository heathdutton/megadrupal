<?php
/**
 * @file
 * Code for the Sprout Devel feature.
 */

include_once 'sprout_devel.features.inc';

function sprout_devel_enable() {
  $shortcuts = new stdClass();
  $shortcuts->title = 'Devel';
  $shortcuts->links = array(
    array(
      'link_path' => 'node/add',
      'link_title' => 'Add Content',
      'weight' => -50,
    ),
    array(
      'link_path' => 'admin/structure/types',
      'link_title' => 'Content types',
      'weight' => -49,
    ),
    array(
      'link_path' => 'admin/structure/menu',
      'link_title' => 'Menus',
      'weight' => -48,
    ),
    array(
      'link_path' => 'admin/structure/features',
      'link_title' => 'Features',
      'weight' => -47,
    ),
    array(
      'link_path' => 'admin/structure/views',
      'link_title' => 'Views',
      'weight' => -46,
    ),
    array(
      'link_path' => 'admin/structure/context',
      'link_title' => 'Context',
      'weight' => -45,
    ),
    array(
      'link_path' => 'admin/people/permissions',
      'link_title' => 'Permissions',
      'weight' => -44,
    ),
    array(
      'link_path' => 'admin/config/development/performance',
      'link_title' => 'Performance',
      'weight' => -43,
    ),
  );

  shortcut_set_save($shortcuts);

  // Set user 1 to use this shortcut set
  $record = array(
    'uid' => 1,
    'set_name' => $shortcuts->set_name,
  );

  drupal_write_record('shortcut_set_users', $record);

  // reroute email settings
  variable_set('reroute_email_address', variable_get('site_mail'));
  variable_set('reroute_email_enable', '1');
}

function sprout_devel_disable() {
  shortcut_set_delete('shortcut-set-2');

  $num_deleted = db_delete('shortcut_set_users')
    ->condition('uid', '1')
    ->condition('set_name', 'shortcut-set-2')
    ->execute();
}