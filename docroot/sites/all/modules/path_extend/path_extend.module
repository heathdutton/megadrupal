<?php
function path_extend_url_inbound_alter(&$path, $original_path, $path_language) {
  global $user;
  global $_GET;
  if (preg_match('|^node/page/(\d+).html|', $original_path, $matches) ) {
    $_GET['page'] = $matches[1];
    $path = 'node';
  }
  if (preg_match('|^(.*)/page/(\d+).html|', $original_path, $matches) ) {
    $path = $matches[1];//. '?page=' . $matches[2];
    $_GET['page'] = $matches[2];
    $original_path = $matches[1] . '.html';
  }
  // Change all article/x requests to node/x
  if (preg_match('|^node(/.*).html|', $original_path, $matches)) {
    $path = 'node'. $matches[1];
  }
  if (preg_match('|^tags(/.*).html|', $original_path, $matches) ) {
    $path = 'taxonomy/term'. $matches[1];
  }
  // Redirect a path called 'e' to the user's profile edit page.
  if ($original_path == 'e') {
    $path = 'user/'. $user->uid .'/edit';
  }
}
function path_extend_url_outbound_alter(&$path, &$options, $original_path) {
  global $user;
  // WORK ON SITUATION FOR DIFFERENT LANGUAGE
  $language = !empty($options['language']->language) ? $options['language']->language : NULL;
  $alias = drupal_get_path_alias($original_path, $language);
  if($alias != $original_path) {
    return;
  }
  if (preg_match('|^node(/.*)|', $path, $matches) ) {
    $path = 'node'. $matches[1] . '.html';
  }
  if (preg_match('|^taxonomy/term(/.*)|', $path, $matches) ) {
    $path = 'tags'. $matches[1] . '.html';
  }
  if (
    isset($options['query'] ) 
    && isset($options['query']['page'] )
    && is_numeric($options['query']['page'] )
  ){
    // check if $path already ends with .html
    if ( preg_match('|^(.*).html$|', $path, $matches1) ) {
      $path = $matches1[1];
    }
    $path = $path . '/page/' . $options['query']['page'] . '.html';
    unset($options['query']['page'] );
  }
}
