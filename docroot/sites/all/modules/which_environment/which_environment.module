<?php
/**
 * @file
 * Which Environment?
 */

 /**
 * Implements hook_help().
 *
 * @return string
 */
function which_environment_help($path, $arg) {
  switch ($path) {
    case 'admin/help#which':
      $output = '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('The Which Environment? module allows site administrators to define development and testing environments for their site. JavaScript then adds page notifications.', array('@which' => 'http://drupal.org/')) . '</p>';
      $output .= '<h3>' . t('Uses') . '</h3>';
      $output .= '<dl>';
      $output .= '<dt>' . t('Environment Indication') . '</dt>';
      $output .= '<dd>' . t('A HTML overlay will be placed on the site indicating which environment Administrators are working on. This minimises human error.', array('@shortcuts-help' => url('admin/help/shortcut'))) . '</dd>';
      $output .= '</dl>';
      return $output;
  }
}

 /**
 * Implements hook_permission().
 *
 * @return array
 */
function which_environment_permission() {
  return array(
    'view which environment' => array(
      'title' => t('View Which Environment? settings'),
    ),
  );
}

/**
 * Implements hook_page_alter().
 */
function which_environment_page_alter() {
  if (user_access('view which environment')) {
    $environment_config = variable_get('which_environment', 'No environment set');
    drupal_add_js(array('which_environment' => array('which_environment_type' => $environment_config['type'])), array('type' => 'setting'));
    drupal_add_js(drupal_get_path('module', 'which_environment') . '/which_environment.js');
    drupal_add_css(drupal_get_path('module', 'which_environment') . '/which_environment.css');
  }
}
