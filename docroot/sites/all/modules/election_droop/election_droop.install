<?php
/**
 * @file
 * Install functions for the Election Droop Integration module.
 */

/**
 * Implements hook_requirements().
 */
function election_droop_requirements($phase) {
  $requirements = array();
  $t = get_t();
  // Report on the existence of the Droop library.
  if ($phase == 'runtime') {
    $output = array(
      'title' => $t('Droop STV election-counting framework'),
    );
    if ($droophp_path = _election_droop_get_path()) {
      $output += array(
        'value' => $t('Installed'),
        'severity' => REQUIREMENT_OK,
      );
    }
    else {
      $output += array(
        'value' => $t('Not installed'),
        'description' => $t(
          'You need to <a href="@droop_url">download Droop</a> and install it to the directory <code>@libraries_path</code>. The Droop.py executable should be at <code>@libraries_path/Droop.py</code>.',
          array(
            '@libraries_path' => libraries_get_path('droop'),
            '@droop_url' => 'http://code.google.com/p/droop/wiki/Droop',
          )
        ),
        'severity' => REQUIREMENT_WARNING,
      );
    }
    $requirements['election_droop'] = $output;
  }
  return $requirements;
}
