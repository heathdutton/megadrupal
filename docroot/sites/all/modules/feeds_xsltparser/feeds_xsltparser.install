<?php
/**
 * @file
 * Installation related hooks for Feeds XSLT Pipeline Parser plugin.
 */

/**
 * Implements hook_requirements().
 */
function feeds_xsltparser_requirements($phase) {
  $requirements = array();
  // Ensure translations don't break at install time
  $t = get_t();

  $has_xsl = extension_loaded('xsl');
  $has_domdocument = method_exists('DOMDocument', 'loadXML');

  $requirements['feeds_xsltparser_php_domdocument'] = array(
    'title' => $t('PHP DOMDocument class'),
    'value' => $has_domdocument ? $t('Enabled') : $t('Not found'),
  );
  if (!$has_domdocument) {
    $requirements['feeds_xsltparser_php_domdocument']['severity'] = REQUIREMENT_ERROR;
    $requirements['feeds_xsltparser_php_domdocument']['description'] = $t('The feeds XSLT pipeline parser module requires the DOMDocument class to be available. Check the configure command at the <a href="@link-phpinfo">PHP info page</a>.', array('@link-phpinfo' => url('admin/reports/status/php')));
  }

  $requirements['feeds_xsltparser_php_xsl'] = array(
    'title' => $t('PHP XSL Extension'),
    'value' => $has_xsl ? $t('Enabled') : $t('Not found'),
  );
  if (!$has_xsl) {
    $requirements['feeds_xsltparser_php_xsl']['severity'] = REQUIREMENT_ERROR;
    $requirements['feeds_xsltparser_php_xsl']['description'] = $t('The feeds XSLT pipeline parser module requires the PHP XSL extension to be available. Check the configure command at the <a href="@link-phpinfo">PHP info page</a>.', array('@link-phpinfo' => url('admin/reports/status/php')));
  }

  return $requirements;
}
