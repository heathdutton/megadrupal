<?php

/**
 * @file
 * Tests for the Admin notification module.
 */
class AdminNotificationTests extends DrupalWebTestCase {
  /**
   * Metadata about our test case.
   */
  public static function getInfo() {
    return array(
      'name' => 'Admin Notification',
      'description' => 'Tests for the Admin Notification module.',
      'group' => 'Admin Notification',
    );
  }

  /**
   * Perform any setup tasks for our test case.
   */
  public function setUp() {
    parent::setUp(array('admin_notification'));
  }

  public function testAdminNotification() {
    $user = $this->drupalCreateUser(array('administer admin notification'));
    $this->drupalLogin($user);

    $vars = array(
      'admin_notification_enabled' => TRUE,
      'admin_notification_message' => 'Testing the notification message',
      'admin_notification_type' => 'error',
    );
    $this->drupalPost('admin/config/administration/admin_notification', $vars, t('Save configuration'));

    $this->assertText($vars['admin_notification_message'], t('Notification message shown'));

    $this->drupalGet('admin/config/administration/admin_notification');
    $this->assertFieldByXpath("//form[@id='admin-notification-admin']//input[@name='admin_notification_enabled']", $vars['admin_notification_enabled'], t('Notification enabled in form'));
    $this->assertFieldByXpath("//form[@id='admin-notification-admin']//input[@name='admin_notification_message']", $vars['admin_notification_message'], t('Notification message in form'));
    $this->assertFieldByXpath("//form[@id='admin-notification-admin']//select[@name='admin_notification_type']", $vars['admin_notification_type'], t('Notification type in form'));
  }
}
