<?php
/**
 * @file
 * X-GitSHA HTTP Header module file
 *
 * @see http://blog.andrewvc.com/making-life-easier-with-git-shas-in-your-http
 */

/**
 * Gets the SHA hash of the current Git checkout.
 */
function xgitsha_get_sha() {
  // Possibly make sure/check that we're in Drupal's root dir. And that the root
  // dir has a .git dir as well?
  return shell_exec('git rev-parse HEAD');
}

/**
 * Implements hook_init().
 */
function xgitsha_init() {
  if (variable_get('xgitsha_add_header', TRUE)) {
    $gitsha = xgitsha_get_sha();
    drupal_add_http_header('X-GitSHA', $gitsha);
  }
}
