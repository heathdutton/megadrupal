<?php

/**
 * @file
 * Create a button on node form that allows to create a node and continue to create another node of that type
 */

/**
 * Implements hook_form_FORM_ID_alter()
 */
function createandcontinue_form_node_form_alter(&$form, &$form_state) {  
  if (arg(0) == 'node' && arg(1) == 'add') {
    $form_state['createandcontinue'] = $_GET['q'];
    $form['actions']['submit']['#subit'][] = 'createandcontinue_submit';
    $form['actions']['createandcontinue'] = $form['actions']['submit'];
    $form['actions']['createandcontinue']['#value'] = t('Create and continue');
    $form['actions']['createandcontinue']['#submit'][] = 'createandcontinue_submit';
  }
}

/**
 * Submit callback to set the redirect
 * @param type $form
 * @param type $form_state
 */
function createandcontinue_submit(&$form, &$form_state) {
  if ($form_state['triggering_element']['#id'] == 'edit-createandcontinue') {
    $form_state['redirect'] = $form_state['createandcontinue'];
  }  
}
