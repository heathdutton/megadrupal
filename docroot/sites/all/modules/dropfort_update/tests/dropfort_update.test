<?php
/**
 * @file
 * Tests for Dropfort Update
 */

class DropfortUpdateTestCase extends DrupalWebTestCase {
  public static function getInfo() {
    return array(
      'name' => t('Dropfort Update tests'),
      'description' => t('Test the functionality of Dropfort Update'),
      'group' => t('Dropfort'),
    );
  }

  function setUp() {
    parent::setUp('dropfort_update');
  }

  /**
   * Tests to check the keys generated by dropfort_update
   */
  function testSiteKeyGenerator() {
    // Ensure the site key generated by the update module matches
    // the key dropfort_update generates
    // @see https://api.drupal.org/api/drupal/modules%21update%21update.fetch.inc/function/_update_process_fetch_task/7
    global $base_url;
    $update_site_key = drupal_hmac_base64($base_url, drupal_get_private_key());
    $dropfort_site_key = _dropfort_update_get_private_key();

    $this->assertEqual($update_site_key, $dropfort_site_key, 'Site keys match');
  }
}
