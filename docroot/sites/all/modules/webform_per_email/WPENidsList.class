<?php

/**
 * @file
 * WPENidsList class for Webform per Email module.
 */

/**
 * WPENidsList Class.
 *
 * Manages the list of nids for which permit is required.
 */
class WPENidsList {

  /**
   * Returns the complete list of nids from the db.
   */
  public static function getList() {
    $result = db_select('webform_per_email_nids_list', 'w')
      ->fields('w', array('nid'))
      ->execute()
      ->fetchAll();
    return $result;
  }

  /**
   * Checks if the given nid exists in the list of nids.
   *
   * Returns TRUE of FALSE.
   */
  public static function exists($nid) {
    $result = db_select('webform_per_email_nids_list', 'w')
      ->fields('w', array('nid'))
      ->condition('nid', $nid, '=')
      ->execute()
      ->rowCount();
    return $result ? TRUE : FALSE;
  }

  /**
   * Adds the given nid to the list.
   */
  public static function add($nid) {
    db_merge('webform_per_email_nids_list')
      ->key(array('nid' => $nid))
      ->fields(array(
        'nid' => $nid,
      ))
      ->execute();
  }

  /**
   * Removes the given nid from the list.
   */
  public static function remove($nid) {
    db_delete('webform_per_email_nids_list')
      ->condition('nid', $nid)
      ->execute();
  }

}
