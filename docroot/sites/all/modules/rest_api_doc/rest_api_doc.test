<?php

/**
 * @file
 * Contains RestApiDocTest.
 */

/**
 * Tests self document REST API functionality.
 *
 * @group rest_api_doc
 */
class RestApiDocTest extends DrupalWebTestCase {

  public static function getInfo() {
    return array(
      'name' => 'REST API documentation',
      'description' => 'Tests the REST self documentation',
      'group' => 'Services',
    );
  }

  public function setUp() {
    return parent::setUp($this->modules);
  }

  /**
   * Modules to enable.
   *
   * @var array
   */
  public $modules = array(
    'restws',
    'rest_api_doc',
  );

  /**
   * Tests module functionality.
   */
  public function testRestApiDoc() {
    $user = $this->drupalCreateUser();
    $rest_user = $this->drupalCreateUser(array('access rest_api_doc'));

    $this->drupalLogin($user);
    $this->drupalGet('api/doc');
    $this->assertResponse(403);

    $this->drupalLogin($rest_user);
    $this->drupalGet('api/doc');
    $this->assertResponse(200);
  }

}
