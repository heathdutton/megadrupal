<?php

/**
 * @file
 * Install and uninstall handling of module.
 */

/**
 * Implements hook_schema_alter().
 *
 * Adds new field drupal_nid to schema.
 */
function biblio_author_node_schema_alter(&$schema) {
  $schema['biblio_contributor_data']['fields']['drupal_nid'] = array(
    'type' => 'int',
    'not null' => FALSE,
    'unsigned' => TRUE,
    'default' => NULL,
    'description' => 'Drupal Node ID',
  );
}

/**
 * Implements hook_install().
 *
 * Adds new field drupal_nid.
 */
function biblio_author_node_install() {
  $schema = drupal_get_schema('biblio_contributor_data');
  db_add_field('biblio_contributor_data', 'drupal_nid', $schema['fields']['drupal_nid']);
  db_update('system')
    ->fields(array(
      'weight' => 30,
    ))
    ->condition('name', 'biblio_author_node')
    ->execute();
}

/**
 * Implements hook_uninstall().
 *
 * Delete module custom variables and database fields.
 */
function biblio_author_node_uninstall() {
  variable_del('biblio_author_node_link');
  variable_del('biblio_author_node_link_bundle');
  db_drop_field('biblio_contributor_data', 'drupal_nid');
}
