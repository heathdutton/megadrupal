<?php

/**
 * Implements hook_uninstall().
 */
function commerce_preorder_uninstall() {
  drupal_load('module', 'commerce_preorder');



  // Delete any product fields managed by this module
/**@todo should we delete the product fields or keep ?? ***/
  $product_fields = _commerce_preorder_managed_product_fields();
  if (!empty($product_fields) && !empty($product_fields['fields'])) {
    foreach ($product_fields['fields'] as $field_name => $field_info) {
      commerce_delete_field($field_name);
    }
  }

  // Delete any order fields managed by this module
/**@todo should we delete the order fields or keep ?? ***/
/*
  $order_fields = _commerce_preorder_managed_order_fields();
  if (!empty($order_fields) && !empty($order_fields['fields'])) {
    foreach ($order_fields['fields'] as $field_name => $field_info) {
      commerce_delete_field($field_name);
    }
  }
*/

  // Delete variables
  $query = db_select('variable')
    ->fields('variable', array('name'))
    ->condition('name', db_like('commerce_preorder') . '%', 'LIKE');
  $result = $query->execute();

  foreach ($result as $record) {
    variable_del($record->name);
  }
}

