<?php

/**
 * @file
 * Installation file for Gallery Link module.
 */

/**
 * Implements hook_requirements().
 */
function gallery_link_requirements($phase) {
  $requirements = array();
  $t = get_t();

  if ($phase == 'runtime') {

    // Get path to fancybox library.
    $path = libraries_get_path('fancybox');
    // Check whether necessary css and js files are available.
    $css = file_exists($path . '/jquery.fancybox-' . GALLERY_LINK_FANCYBOX_VERSION . '.css');
    $js = file_exists($path . '/jquery.fancybox-' . GALLERY_LINK_FANCYBOX_VERSION . '.pack.js');

    // If they not available, report an error.
    if (!$css && !$js) {
      $requirements['gallery_link_fancybox'] = array(
        'title' => $t('Gallery Link'),
        'value' => $t('Not Found'),
        'severity' => REQUIREMENT_ERROR,
        'description' => $t('You need to <a href="!url">download</a> fancybox @version and put the extracted fancybox folder into <code>sites/all/libraries/</code>.', array(
          '!url' => url('http://fancybox.googlecode.com/files/jquery.fancybox-' . GALLERY_LINK_FANCYBOX_VERSION . '.zip'),
          '@version' => GALLERY_LINK_FANCYBOX_VERSION,
        )),
      );
    }
  }

  return $requirements;
}

