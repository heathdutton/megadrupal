<?php

/**
 * @file
 * Hook implementations and shared functions.
 *
 * @see BankingCreditCardFormElement
 */

/**
 * Implements hook_menu().
 */
function banking_test_menu() {
  $items['banking_test_form_element_banking_credit_card'] = array(
    'title' => 'Test the banking_credit_card form element',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('banking_test_form_element_banking_credit_card'),
    'access callback' => TRUE,
  );
  $items['banking_test_form_element_banking_iban'] = array(
    'title' => 'Test the banking_iban form element',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('banking_test_form_element_banking_iban'),
    'access callback' => TRUE,
  );
  $items['banking_test_form_element_banking_bic'] = array(
    'title' => 'Test the banking_bic form element',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('banking_test_form_element_banking_bic'),
    'access callback' => TRUE,
  );

  return $items;
}

/**
 * Implements form build callback: show a banking_credit_card element.
 */
function banking_test_form_element_banking_credit_card(array $form, array &$form_state) {
  $form['#submit'] = array('banking_test_form_submit');
  $form['banking_credit_card'] = array(
    '#title' => t('Credit card'),
    '#type' => 'banking_credit_card',
  );
  $form['submit'] = array(
    '#type' => 'submit',
    '#value' => t('Submit'),
  );

  return $form;
}

/**
 * Implements form build callback: show a banking_iban element.
 */
function banking_test_form_element_banking_iban(array $form, array &$form_state) {
  $form['#submit'] = array('banking_test_form_submit');
  $form['banking_iban'] = array(
    '#title' => t('IBAN'),
    '#type' => 'banking_iban',
  );
  $form['submit'] = array(
    '#type' => 'submit',
    '#value' => t('Submit'),
  );

  return $form;
}

/**
 * Implements form build callback: show a banking_bic element.
 */
function banking_test_form_element_banking_bic(array $form, array &$form_state) {
  $form['#submit'] = array('banking_test_form_submit');
  $form['banking_bic'] = array(
    '#title' => t('BIC'),
    '#type' => 'banking_bic',
  );
  $form['submit'] = array(
    '#type' => 'submit',
    '#value' => t('Submit'),
  );

  return $form;
}

/**
 * Implements form submit callback for testing the submission of form elements.
 */
function banking_test_form_submit(array $form, array &$form_state) {
  // Redirect, so we can test whether form errors were thrown.
  $form_state['redirect'] = 'user';
  variable_set('banking_test_form_submit', $form_state['values']);
}
