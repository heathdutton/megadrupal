<?php

/**
 * @todo add uninstall hook for variables
 */

function vgwort_schema() {
  $schema['vgwort'] = array(
    // Example (partial) specification for table "node".
    'description' => 'Hold vgwort marks.',
    'fields' => array(
      'mid' => array(
       'description' => 'The primary identifier for a node.',
        'type' => 'serial',
        'unsigned' => TRUE,
        'not null' => TRUE,
      ),
      'domain' => array(
        'description' => 'Domain to call.',
        'type' => 'varchar',
        'length' => 255,
        'not null' => TRUE,
      ),
      'private' => array(
        'description' => 'private id.',
        'type' => 'varchar',
        'length' => 40,
        'not null' => TRUE,
      ),
      'public' => array(
        'description' => 'public id.',
        'type' => 'varchar',
        'length' => 40,
        'not null' => TRUE,
      ),
      'entity_id' => array(
          'description' => 'public id.',
          'type' => 'int',
          'length' => 10,
          'not null' => FALSE,
      ),
      'entity_type' => array(
          'description' => 'entity type.',
          'type' => 'varchar',
          'length' => 128,
          'not null' => FALSE,
      ),
      'status' => array(
        'description' => 'Status of the mark',
        'type' => 'int',
        'unsigned' => TRUE,
        'not null' => TRUE,
      ),
      'modified' => array(
        'description' => t('Last status change.'),
        'type' => 'int',
        'not null' => TRUE,
        'default' => 0
      ),
      'test' => array(
        'description' => 'Is test mark',
        'type' => 'int',
        'unsigned' => TRUE,
        'not null' => TRUE,
      ),
    ),
    'indexes' => array(
      'status' => array('status'),
    ),
    'primary key' => array('mid'),

  );
  return $schema;
}

function vgwort_install() {
  variable_set('vgwort_test', 1) ;
}

function vgwort_uninstall() {
  variable_del('vgwort_test') ;
  variable_del('vgwort_user') ;
  variable_del('vgwort_password') ;
  variable_del('vgwort_bundles') ;
  variable_del('vgwort_threshold') ;
  variable_del('vgwort_import') ;
}

function vgwort_update_7000() {
  $spec =  array(
        'description' => t('Last status change.'),
        'type' => 'int',
        'not null' => TRUE,
        'default' => 0
  );
  db_drop_field('vgwort', 'modified') ;
  db_add_field('vgwort', 'modified', $spec) ;
}