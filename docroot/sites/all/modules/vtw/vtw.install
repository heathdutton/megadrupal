<?php

/**
 * Implements hook_install().
 */

function vtw_install() {
  $fields['sql_weight'] = array(
    'type' => 'int',
    'unsigned' => true,
    'not null' => true,
    'default' => 0,
    'description' => 'Term weight',
  );
  $fields['sql_depth'] = array(
    'type' => 'int',
    'unsigned' => true,
    'not null' => true,
    'default' => 0,
    'description' => 'Term depth',
  );
  if (!db_field_exists('taxonomy_term_hierarchy', 'sql_weight')) {
    db_add_field('taxonomy_term_hierarchy', 'sql_weight', $fields['sql_weight']);
  }
  if (!db_field_exists('taxonomy_term_hierarchy', 'sql_depth')) {
    db_add_field('taxonomy_term_hierarchy', 'sql_depth', $fields['sql_depth']);
  }
  vtw_index_rebuild();
}

/**
 * Implements hook_uninstall().
 */

function vtw_uninstall() {
  if (db_field_exists('taxonomy_term_hierarchy', 'sql_weight')) {
    db_drop_field('taxonomy_term_hierarchy', 'sql_weight');
  }
  if (db_field_exists('taxonomy_term_hierarchy', 'sql_depth')) {
    db_drop_field('taxonomy_term_hierarchy', 'sql_depth');
  }
  db_delete('variable')->condition('name', 'vtw_%', 'like')->execute();
}

/**
 * Implements hook_enable().
 */

function vtw_enable() {
  vtw_index_rebuild();
}

