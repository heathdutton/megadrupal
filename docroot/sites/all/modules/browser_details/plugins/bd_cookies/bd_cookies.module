<?php

/**
 * Implements hook_menu().
 */
function bd_cookies_menu() {
    $items = array();
    $items['browser-details/cookies'] = array(
        'type' => MENU_CALLBACK,
        'page callback' => 'bd_cookies_load_iframe',
        'access callback' => true,
    );

    return $items;
}

/**
 * Implements hook_browser_details_plugin().
 */
function bd_cookies_browser_details_plugin() {
    return array(
        'cookies' => array(
            'name' => 'cookies',
            'title' => 'Cookies',
            'icon' => drupal_get_path('module', 'bd_cookies') . '/images/bd_cookies.png',
            'content' => 'bd_cookies_load_content',
        ),
    );
}

function bd_cookies_load_content() {
    setcookie('browser-details', 'test');
    return '<iframe style="border: none; width: 100%;" src="' . url('browser-details/cookies') . '"></iframe>';
}

function bd_cookies_load_iframe() {
    if ($_COOKIE['browser-details'] == 'test')
        die('Enabled'); 
    else
        die('Disabled'); 
}
