<?php
/**
* Tests the functionality of the FileMaker module.
*/
class FilemakertestExampleTestCase extends DrupalWebTestCase {
  
  protected $privileged_user;

  protected $database_name = 'fmwebtest';
  protected $user_name = 'fmwebtest';
  protected $password = 'p4';
  protected $host_name = 'fm34.triple8.net';
  protected $port = 80;
  protected $https = '';

  public static function getInfo() {
    return array(
      'name' => 'FileMaker Test',
      'description' => 'Build and run tests.',
      'group' => 'FileMaker',
    );
  }

  public function setUp() {
    
    parent::setUp(array('filemaker'));
    $this->privileged_user = $this->drupalCreateUser(array(
    	'administer filemaker connections',
		'filemaker create mode',
		'filemaker find mode',
		'filemaker browse mode',
		'filemaker edit record',
		'filemaker delete record',
		'filemaker layout mode',
		'create filemaker web layouts',
		'create filemaker content',
    ));
    $this->drupalLogin($this->privileged_user);
  }

  /**
   * Tests creation of a FileMaker connection.
   */
  public function testFilemakerConnectionCreate() {
    $edit = array();
    $edit['database_name'] = $this->database_name;
    $edit['user_name'] = $this->user_name;
    $edit['password'] = $this->password;
    $edit['host_name'] = $this->host_name;
    $edit['port'] = $this->port;
    $edit['https'] = FALSE; // $this->https;
    $this->drupalPost('admin/config/development/filemaker/connection', $edit, t('Save Connection'));
    $this->assertText('Connected to FileMaker');
    $edit = array();
    $edit['title'] = $this->randomName(8);
    $this->drupalPost('node/add/filemaker', $edit, t('Save'));
    $this->assertText(t('Please select which FileMaker layout to use.'));
  }
  
  /**
   * Tests creation of a FileMaker node.
   */
  public function testFilemakerCreate() {
    $edit = array();
    $edit['title'] = $this->randomName(8);
    // $this->drupalPost('node/add/filemaker', $edit, t('Save'));
    // $this->assertText(t('FileMaker Node Type @title has been created.', array('@title' => $edit['title'])));
  }
}
