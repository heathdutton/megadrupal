<?php

/**
 * @file
 * Integrate the SwipeView library into views as a style plugin.
 */


define('VIEWS_SWIPEVIEW_VERSION', '1.0');

/**
 * Implements hook_views_api().
 */
function views_swipeview_views_api() {
  return array(
    'api' => 3,
  );
}

/**
 * Implements hook_library().
 */
function views_swipeview_library() {
  $library_path = libraries_get_path('swipeview');
  $module_path = drupal_get_path('module', 'views_swipeview');

  // In order of preference.
  $javascript_file_candidates = array(
    $library_path . '/swipeview.min.js',
    $library_path . '/swipeview.js',
  );
  $swipeview_library_file = FALSE;
  foreach ($javascript_file_candidates as $candidate) {
    if (file_exists($candidate)) {
      $swipeview_library_file = $candidate;
      break;
    }
  }
  $libraries['swipeview'] = array(
    'title' => 'SwipeView',
    'website' => 'http://cubiq.org/swipeview',
    'version' => VIEWS_SWIPEVIEW_VERSION,
    'js' => array(
      $module_path . '/theme/views-swipeview.js' => array(),
    ),
    'css' => array(
      $module_path . '/theme/views-swipeview.css' => array(),
    ),
  );
  if ($swipeview_library_file !== FALSE) {
    $libraries['swipeview']['js'][$swipeview_library_file] = array();
  }
  return $libraries;
}

/**
 * Implements hook_theme().
 */
function views_swipeview_theme($existing, $type, $theme, $path) {
  $module_path = drupal_get_path('module', 'views_swipeview');
  return array(
    'views_swipeview_slideshow' => array(
      'path' => $module_path . '/theme',
      'template' => 'views-swipeview-slideshow',
      'variables' => array(
        'view' => NULL,
        'options' => NULL,
        'rows' => NULL,
        'title' => NULL,
      ),
    ),
  );
}
