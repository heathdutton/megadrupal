<?php

/**
 * @file
 * Paginate example
 *
 * Display various combinations of Paginate themes.
 *
 * @package  User interface
 * @author   devendra.yadav <dev.firoza@gmail.com>
 */

/**
 * Implements hook_menu().
 */
function paginate_example_menu() {
  $items['paginate/example'] = array(
    'title' => 'Paginate example',
    'type' => MENU_NORMAL_ITEM,
    'page callback' => 'drupal_get_form',
    'page arguments' => array('paginate_example_form'),
    'access callback' => TRUE,
    'description' => 'Display various combinations of Paginate themes.',
  );

  $items['paginate/example/paginate_istandard'] = array(
    'title' => 'Paginate Input Standard',
    'type' => MENU_DEFAULT_LOCAL_TASK,
    'weight' => -5,
  );

  $items['paginate/example/paginate_standard'] = array(
    'title' => 'Paginate Standard',
    'type' => MENU_LOCAL_TASK,
    'page callback' => 'drupal_get_form',
    'page arguments' => array('paginate_example_form'),
    'access callback' => TRUE,
    'weight' => -4,
  );

  $items['paginate/example/paginate_imini'] = array(
    'title' => 'Paginate Input Mini',
    'type' => MENU_LOCAL_TASK,
    'page callback' => 'drupal_get_form',
    'page arguments' => array('paginate_example_form'),
    'access callback' => TRUE,
    'weight' => -3,
  );

  $items['paginate/example/paginate_mini'] = array(
    'title' => 'Paginate Mini',
    'type' => MENU_LOCAL_TASK,
    'page callback' => 'drupal_get_form',
    'page arguments' => array('paginate_example_form'),
    'access callback' => TRUE,
    'weight' => -2,
  );

  return $items;
}

/**
 * Build the paginate example.
 *
 * @return array
 *   A render array.
 */
function paginate_example_form($form, &$form_state) {
  $header = array(
    array('data' => 'wid'),
    array('data' => 'type'),
    array('data' => 'timestamp'),
  );
  $query = db_select('watchdog', 'd')->extend('PagerDefault');
  $query->fields('d', array('wid', 'type', 'timestamp'));
  $result = $query->limit(10)
    ->orderBy('d.wid')
    ->execute();

  $rows = array();
  foreach ($result as $row) {
    $rows[] = array('data' => (array) $row);
  }

  $form['content'] = array(
    '#theme' => 'table',
    '#header' => $header,
    '#rows' => $rows,
    '#empty' => t("There are no watchdog records found in the db"),
  );

  $arg = arg();
  $pager_theme = isset($arg['2']) ? $arg['2'] : 'paginate_istandard';
  $form['data'] = array('#markup' => theme($pager_theme));
  return $form;
}
