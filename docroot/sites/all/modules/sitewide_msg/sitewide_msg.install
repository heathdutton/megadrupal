<?php
/**
 * @file
 * Install/uninstall related functions.
 */

/**
 * Implements hook_install().
 */
function sitewide_msg_install() {
  _sitewide_msg_user_grant_permissions();
}

/**
 * Implements hook_uninstall().
 */
function sitewide_msg_uninstall() {
  // Purge our variables.
  $result = db_delete("{variable}")
    ->condition('name', "sitewide_msg_%", 'LIKE')
    ->execute();
}

/**
 * Implements hook_update_n().
 */
function sitewide_msg_update_7100() {
  _sitewide_msg_user_grant_permissions();
}

/**
 * Grant permissions to receive sitewide messages for all user roles.
 */
function _sitewide_msg_user_grant_permissions() {
  $roles = array_keys(user_roles());

  foreach($roles as $role) {
    user_role_grant_permissions($role, array('receive sitewide messages'));
  }
}
