<?php
/**
 * @file
 * Install, update and uninstall functions for the Verticrawl search module.
 */

/**
 * Implements hook_install().
 */
function verticrawl_search_install() {
  $table = 'verticrawl_configs';
  $primary_key = 'config_id';

  // Default values.
  $configs = array(
    // SEARCH PAGE.
    'config_search_php_api_key' => array(
      'config_id' => 101,
      'config_name' => 'search_php_api_key',
      'config_value' => '9f3c5badb804201eaa6edd0655716063',
    ),
    'config_search_page_path' => array(
      'config_id' => 201,
      'config_name'  => "search_page_path",
      'config_value'   => 'verticrawl-search',
    ),
    'config_search_page_title' => array(
      'config_id' => 202,
      'config_name'  => "search_page_title",
      'config_value'   => 'Verticrawl Search',
    ),
    'config_search_page_description' => array(
      'config_id' => 203,
      'config_name'  => "search_page_description",
      'config_value'   => 'Here is a description of your search page !',
    ),
    'config_search_page_description_format' => array(
      'config_id' => 204,
      'config_name'  => "search_page_description_format",
      'config_value'   => 'filtered_html',
    ),
    'config_search_result_keyword_wrapper' => array(
      'config_id' => 205,
      'config_name'  => "search_result_keyword_wrapper",
      'config_value'   => 'strong',
    ),
    // ADVANCED SEARCH.
    'config_advanced_search_sort_by' => array(
      'config_id' => 301,
      'config_name'  => "config_advanced_search_sort_by",
      'config_value'   => 1,
    ),
    'config_advanced_search_match_mode' => array(
      'config_id' => 302,
      'config_name'  => "config_advanced_search_match_mode",
      'config_value'   => 1,
    ),
    'config_advanced_search_document_type' => array(
      'config_id' => 303,
      'config_name'  => "config_advanced_search_document_type",
      'config_value'   => 1,
    ),
    'config_advanced_search_site_url' => array(
      'config_id' => 304,
      'config_name'  => "config_advanced_search_site_url",
      'config_value'   => 1,
    ),
    'config_advanced_search_group_by_site' => array(
      'config_id' => 305,
      'config_name'  => "config_advanced_search_group_by_site",
      'config_value'   => 1,
    ),
    'config_advanced_search_filter_by_date' => array(
      'config_id' => 306,
      'config_name'  => "config_advanced_search_filter_by_date",
      'config_value'   => 1,
    ),
    // POWERED BY.
    'config_display_powered_by' => array(
      'config_id' => 399,
      'config_name'  => "display_powered_by",
      'config_value'   => 1,
    ),
  );

  foreach ($configs as $data) {
    $entry_exists = db_select($table, 't')
      ->fields('t', array($primary_key))
      ->condition($primary_key, $data[$primary_key], '=')
      ->execute()
      ->rowCount();

    if (!$entry_exists) {
      drupal_write_record($table, $data);
    }
  }
}
