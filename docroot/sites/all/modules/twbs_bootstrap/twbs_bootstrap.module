<?php

/**
 * @file
 * Integrate Drupal with Bootstrap library.
 */

/**
 * Implements hook_help().
 */
function twbs_bootstrap_help($path, $arg) {
  $output = '';

  switch ($path) {
    case 'admin/help#twbs_bootstrap':
      return '<p>' . t('Sleek, intuitive, and powerful mobile first front-end framework for faster and easier web development.') . '</p>';
  }

  return $output;
}

/**
 * Implements hook_init().
 */
function twbs_bootstrap_init() {
  drupal_load('module', 'libraries');

  $libraries = twbs_bootstrap_libraries_info();
  foreach ($libraries as $name => $info) {
    libraries_load($name);
  }
}

/**
 * Implements hook_libraries_info().
 */
function twbs_bootstrap_libraries_info() {
  $libraries['bootstrap'] = array(
    'name' => 'Bootstrap',
    'version' => '3.0.3',
    'vendor url' => 'http://getbootstrap.com',
    'download url' => 'https://github.com/twbs/bootstrap/archive/v3.0.3.zip',
    'version arguments' => array(
      'file' => 'dist/css/bootstrap.min.css',
      'pattern' => '/^\s+\*\s+Bootstrap\s+v([0-9a-zA-Z\.-]+)/',
    ),
    'files' => array(
      'css' => array(
        'less/bootstrap.less' => array(
          'every_page' => TRUE,
          'group' => CSS_SYSTEM,
          'weight' => -29,
        ),
        'less/theme.less' => array(
          'every_page' => TRUE,
          'group' => CSS_SYSTEM,
          'weight' => -28,
        ),
      ),
      'js' => array(
        'dist/js/bootstrap.min.js' => array(
          'every_page' => TRUE,
          'group' => JS_LIBRARY,
          'weight' => -29,
        ),
      ),
    ),
    'dependencies' => array(
      'jquery',
    ),
  );

  return $libraries;
}

/**
 * Implements hook_theme().
 */
function twbs_bootstrap_theme() {
  $path = drupal_get_path('module', 'twbs_bootstrap');

  $theme_registry = array();
  $files = file_scan_directory($path . '/theme_registry', '/\.inc$/');
  foreach ($files as $file) {
    require_once ($file->uri);
    $function = $file->name;
    $function($theme_registry);
  }

  return $theme_registry;
}
