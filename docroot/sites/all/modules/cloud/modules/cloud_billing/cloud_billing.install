<?php

/**
 * @file
 * Provides usage estimate table based on user's activities.
 * Works with Cloud module.
 *
 * Copyright (c) 2010-2011 DOCOMO Innovations, Inc.
 *
 */

module_load_include('inc', 'cloud'        , 'cloud_constants'        );
module_load_include('inc', 'cloud_billing', 'cloud_billing_constants');

/**
 * Implementation of hook_install().
 */
function cloud_billing_install() {
  // Create tables.
}

/**
 * Implementation of hook_uninstall().
 */
function cloud_billing_uninstall() {
  // Remove tables.
}

/**
 * Implementation of hook_schema().
 */

function cloud_billing_schema() {

  $schema = array();

  ///To add more schema just add one more $schema['newtable'] array.

  $schema[CLOUD_BILLING_INSTANCES_DETAILS_TABLE] = array(
    'description' => 'Instances Details table',
    'fields' => array(
      'instance_id' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'cloud_type' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'instance_nickname' => array(
        'type' => 'varchar',
        'length' => 256,
      ),
      'image_id' => array(
        'type' => 'varchar',
        'length' => 16,
      ),
      'kernel_id' => array(
        'type' => 'varchar',
        'length' => 16,
      ),
      'ramdisk_id' => array(
        'type' => 'varchar',
        'length' => 16,
      ),
      'owner_id' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'group_id' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'reservation_id' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'platform' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'placement' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'instance_type' => array(
        'type' => 'varchar',
        'length' => 16,
      ),
      'private_dns_name' => array(
        'type' => 'varchar',
        'length' => 255,
      ),
      'dns_name' => array(
        'type' => 'varchar',
        'length' => 255,
      ),
      'key_name' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'instance_state_name' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'instance_state_code' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'ami_launch_index' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'reason' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'product_codes' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'monitoring' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'launch_time' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
      'terminated_date' => array(
        'type' => 'varchar',
        'length' => 64,
      ),
    ),
  );

  return $schema;

}

/**
 * Update instance_nickname field to 256 characters
 */
function cloud_billing_update_7100() {
  db_change_field('cloud_instances_details', 'instance_nickname', 'instance_nickname', array('type' => 'varchar', 'length' => 256));
}

