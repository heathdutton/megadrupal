<?php
/**
 * @file
 * Devicons - Makes the Devicons Font available to Drupal as a library.
 *
 * Maintainer: http://medienverbinder.de
 * Written by Andre Langner
 */

/**
 * Implements hook_libraries_info().
 */
function devicons_libraries_info() {

  $libraries['devicons'] = array(
    'name' => 'Devicons',
    'vendor url' => 'https://github.com/vorillaz/devicons/',
    'download url' => 'https://github.com/vorillaz/devicons/',
    'version arguments' => array(
      'file' => 'css/devicons.css',
      'pattern' => '@(?i:Devicons) ([0-9\.a-z]+)@',
      'lines' => 2,
    ),
    'files' => array(
      'css' => array(
        'css/devicons.css',
      ),
    ),
  );

  return $libraries;
}


/**
 * Implements hook_menu().
 */
function devicons_menu() {

  $items = array();

  $items['admin/config/devicons'] = array(
    'title' => 'Devicons',
    'description' => 'Devicons',
    'position' => 'left',
    'page callback' => 'system_admin_menu_block_page',
    'access arguments' => array('access devicons_demo_page'),
    'file' => 'system.admin.inc',
    'file path' => drupal_get_path('module', 'system'),
    'weight' => -99,
  );

  $items['admin/config/devicons/settings'] = array(
    'title' => 'Devicons Settings',
    'description' => 'Devicons Settings',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('devicons_settings_form'),
    'access arguments' => array('access devicons_demo_page'),
    'weight' => -14,
    'file' => 'devicons.settings.inc',
  );

  $items['admin/config/devicons/demo'] = array(
    'title' => 'Devicons Demo Page',
    'description' => 'Devicon Demo Page.',
    'page callback' => 'devicons_demo_page',
    'access arguments' => array('access devicons_demo_page'),
    'weight' => -13,
    'file' => 'devicons.demo.inc',
  );

  return $items;

}


/**
 * Implements hook_help().
 */
function devicons_help($path, $args) {

  if ($path == 'admin/help#devicons') {

    if (current_path() != 'admin/help/devicons') {
      // Because system_modules() executes hook_help() for each module to 'test'
      // if they will return anything, but not actually display it, we want to
      // return a TRUE value if this is not actually the help page.
      return TRUE;
    }

    $output = '<h1>' . t('Devicons Drupal Module 1.0') . '</h1>';
    $output .= '<p>' . t('This Module makes the Devicons Font available to Drupal as a library: !projectpage', array('!projectpage' => l(t('Visit projectpage'), 'http://vorillaz.github.io/devicons/'))) . '</p>';
    $output .= '<dl>';
    $output .= '<dt>If you can see the Druplicon Icon here, you\'ve done everything right during installation ;-) :<br /><br /> <span class="devicons devicons-drupal" style="font-size: 50px; color:#00598E;"></span></dt><br />';
    $output .= '<h2>Drupal Shell (Drush)</h2>';
    $output .= '<dt>' . t('Download Devicons from project page: <b>drush dl-devicons</b>') . '</dt>';
    $output .= '<dt><br /></dt>';
    $output .= '<dd>' . t('Example output:') . '</dd>';
    $output .= '<dd><pre>' . t('Devicons has been downloaded to sites/all/libraries') . '</pre></dd>';
    $output .= '<dt><br /></dt>';
    $output .= '<dt>' . t('A list of the installed libraries: <b>drush libraries-list</b>') . '</dt>';
    $output .= '<dt><br /></dt>';
    $output .= '<dd>' . t('Example output:') . '</dd>';
    $output .= '<dd><pre>' . t('Name      Status Version Variants Dependencies') . '</pre></dd>';
    $output .= '<dd><pre>' . t('Devicons  OK     1.5.0   ---      ---') . '</pre></dd>';
    $output .= '<dt><br /></dt>';
    $output .= '<dt><br /></dt>';

    return $output;

  }
}

/**
 * Implements hook_init().
 */
function devicons_init() {

  $deviconvar = variable_get('devicons_global');

  if ($deviconvar == 'TRUE') {
    libraries_load('devicons');
  }
}
