<?php
// $Id: svas.module,v 1.1 2011/02/10 17:02:24 quiptime Exp $

/**
 * @file
 * Save any form element values as system variable with AJAX.
 *
 * The SysVar AJAX Saver (SVAS) module is a developer module.
 * Activate the module only if it is used by other modules.
 */

/**
 * AJAX callback to save different form element values from
 * form pages to a corresponding system variable.
 *
 * Example usage:
 * @code
 *   // AJAX form element.
 *   $form['dgb_admin_content_rows'] = array(
 *     '#type' => 'select',
 *     '#title' => t('Entries per page'),
 *     '#options' => drupal_map_assoc(array(10, 25, 50, 75, 100, 150, 200, 250, 500, 750, 1000)),
 *     '#default_value' => variable_get('dgb_admin_content_rows', 50),
 *     '#ajax' => array(
 *       'callback' => 'svas_save'
 *     )
 *   );
 * @endcode
 */
function svas_save($form, &$form_state) {
  $element_name = $form_state['input']['_triggering_element_name'];

  variable_set($element_name, $form_state['input'][$element_name]);

  /**
   * Uncomment this line to use a debug functionality
   * with the 'Variable editor' of the Devel module.
   */
  //variable_set('A-AJAX-SVAS-DEBUG', $form_state['input']);

  return $form[$element_name];
}
