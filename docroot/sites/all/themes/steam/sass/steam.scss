
@import "../../doune/sass/base";
@import "common";

// Bling
$default_transition_property: color;
$default_transition_duration: .25s;
$default_transition_function: linear;
@import "compass/css3/transition";

/**
 * Layout
 */
header[role="banner"] {
  @include clearfix;
  height: 98px;
  padding-top: $nav_height + $page_top_margin;
  position: relative;
  z-index: 1;
}
#header {
  @include float-right;
  margin-top: 28px;
}

#logo, #site-slogan {
  @include float-left;
}

#site-slogan { margin: 29px 0 0 16px; }

#site-name {
  @include element-invisible;
}

#nav {
  position: absolute;
  top: 23px;
  right: 0;
  z-index: 2;
}

#breadcrumb {
  @include float-left;
  height: $content_top_margin;
  width: 100%;
  margin-right: -100%;
}

#footer {
  #block-boxes-footer-box-left {
    float: left;
  }
  #block-boxes-footer-box-right {
    margin-top: 19px;
    float: right;
  }
  #block-boxes-footer-box-left,
  #block-boxes-footer-box-right {
    font-size: 11px;
    color: white;
  }
}

/**
 * Styling
 */
body {
  background-color: $body_bg;
  color: #000;
  @include serif;
}

#page-wrapper {
  background: url('../images/header-bg.jpg') repeat-x;
  height: 100%;
}

h1, h2, h3, h4, h5, h6 {
  @include serif;
}

h2 a, h3 a, h4 a, h5 a, h6 a,
h2 a:visited, h3 a:visited, h4 a:visited, h5 a:visited, h6 a:visited {
  color: $red;
}

h2 a:focus, h3 a:focus, h4 a:focus, h5 a:focus, h6 a:focus,
h2 a:hover, h3 a:hover, h4 a:hover, h5 a:hover, h6 a:hover {
  text-decoration: underline;
  color: $red;
}

h1 {
  font-size: 2.5em;
  line-height: 1em;
}

h2 {
  font-size: 2em;
  font-weight: bold;
  color: $dark_red;
}

h3 {
  font-size: 1.5em;
  color: $dark_red;
}
h4 {
  font-size: 1.3em;
}
ul {
  list-style-position: inside;
  list-style-image: url("../images/li-star.png");
  @include serif;
}

li {
  margin-bottom: .5em;
}

i { font-style: italic; }

a {
  @include link-colors($body_bg, $red, $red);
  @include hover-link;
  @include transition;
}

#main {
  padding-top: 18px;
  padding-bottom: 18px;
}

// hr ornaments
hr {
  border: none;
  height: 19px;
}
hr.top {
  background: transparent url('../images/ornament.png') no-repeat center center;
  margin: 20px 0;
}
hr.bottom {
  background: transparent url('../images/ornament-bottom.png') no-repeat center center;
  margin: 20px 0;
}

/**
 * Lightbox styling
 */
#fancybox-content {
  article {
    margin-bottom: 0;
  }
}

// For some reason, these fancybox-related styles don't work so hot if they're
// restricted to #fancybox, so go backwards and un-apply them if not fancybox
.node-visualization {
  width: 588px;
  min-height: 475px;
  header h2 {
    max-width: 482px;
  }
}
#content .node-visualization {
  width: auto;
  header h2 {
    max-width: none;
  }
}

#page.footnote-taxonomy-term-page {
  // .main-content will provide its own bottom spacing on these pages--this is
  // so that .main-content's background can stretch all the way to page-bottom.
  #main { padding-bottom: 0; }
  div.main-content {
    // Pull our background gradient upward
    margin-top: -20px;
    margin-left: 0;
    padding-top: 20px;
    padding-bottom: 20px;
    background: #F3EEDA url('../images/results-gradient.png') repeat-y top left;
  }
  div.tabs, div.main-content {
    padding-left: 10px;
    padding-right: 10px;
  }
}

.feed-icon {
  @include float-right;
}

#admin-menu ul li { @include sans-serif; }

/**
 * Messages
 */
.messages {
  @include sans-serif;
  margin-top: 10px;
  padding: 5px 10px;
  ul {
    list-style-image: none;
    @include sans-serif;
  }
  &.notice {
    background: $tan;
    border: solid 1px darken($tan, 50%);
  }
  &.status {
    color: $dark_green;
    background: lighten($dark_green, 90%);
    border: solid 1px lighten($dark_green, 70%);
  }
  &.warning {
    background: darken($tan, 10%);
    border: solid 1px $tan;
  }
  &.error {
    color: $dark_red;
    background: lighten($red, 60%);
    border: solid 1px lighten($red, 20%);
  }
}

/**
 * Main content area
 */
#main-wrapper {
  min-height: 709px;
  position: relative;
  z-index: 0;
  background-color: $content_bg;
  @include border-radius();
  @include box-shadow($page_box_shadow);
}

/**
 * Front page
 */
body.front {
  #main #title-tabs-content-wrapper {
    left: 0;
    width: auto;
    padding-left: 20px;
    p {
      margin: 0;
    }
  }
  [id^=block-boxes-front-small] {
    @include float-left;
    margin: 0 20px 20px 0;
  }
}

/**
 * Primary navigation
 */
#main-menu li {
  @include float-left;
  padding-left: 1em;
  z-index: -10;
  a {
    @include border-top-radius(6px);
    @include hover-link;
    color: white;
    display: block;
    font-size: 18px;
    line-height: $nav_height;
    padding: 0 12px;
  }
  a.active {
    background-color: $red;
  }
}
/**
 * Menu block navigation
 */
.block-menu-block {
  margin: 9px 0 0 30px;
  li {
    @include serif;
    margin-bottom: 1.1em;
    font-size: 1.25em;
  }
  li.active,
  li a:hover,
  li a:focus {
    color: $red;
  }
}

/**
 * Blocks
 */
#sidebar_first .block,
#sidebar_second .block {
  min-height: 64px;
}

// Make The Site's right sidebar block's text-in-image align vertically with
// menu block's first entry in left sidebar.
#block-block-9 {
  margin-top: 3px;
}

#block-boxes-footnote-browser-info-left {
  @include clearfix;
  @include border-radius(4px);
  border: 1px solid #E4E4DC;
  background-color: #F3EEDA;
  padding: 0.8em 1em;
  .content {
    // float content to fit inside parent's padding
    @include float-left;
    p { margin-bottom: 0; }
  }
}

.block {
  h2 {
    font-weight: normal;
  }
}
.block-search {
  form { margin-bottom: 10px; }
  .container-inline { position: relative; }
  input[type="search"] {
    border: 2px solid #2D4E5D;
    font-size: 16px;
    width: 100%;
    height: 42px;
    // Prevent input from going behind the search icon
    padding-right: 40px;
  }

  input[type="submit"] {
    @include hide-text;
    background: transparent url('../images/search-icon.png') no-repeat 9px center;
    border: none;
    position: absolute;
    right: 2px;
    top: 2px;
    bottom: 2px;
    width: 39px;
  }
  input[type="submit"]:hover,
  input[type="submit"]:focus {
    background-position: -61px center;
  }
  input[type="submit"]:active {
    background-position: -26px center;
  }
  input[type="submit"]:focus,
  input[type="submit"]:hover,
  input[type="submit"]:active {
    -o-box-shadow: none;
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }
}

/**
 * Breadcrumb
 */
#block-footnote-browser-breadcrumb ul.breadcrumb {
  @include float-left;
  padding: 0 20px;
  width: 960px;

  li {
    @include float-left;
    margin-bottom: 0;
    span {
      // make sure the arrow can be drawn over li's background
      background: transparent url('../images/breadcrumb-arrow.png') no-repeat -16px -5px;
      margin-bottom: -1px;
      height: 31px;
    }
    a, span {
      @include float-left;
      @include serif;
      color: $content_bg;
      font-size: 18px;
      line-height: 30px;
      text-align: center;
    }
    a {
      text-decoration: none;
      height: 30px;
    }
  }

  li.back {
    background-image: url('../images/breadcrumb-back.png');
    background-color: $red;
    background-repeat: no-repeat;
    background-position: 6px 4px;
    border-bottom: 1px solid #AB6F64;
  }
  li.back:hover {
    background-position: 6px -28px;
    color: white;
  }
  li.current {
    background-color: $dark_red;
    border-bottom: 1px solid #A99385;
  }
}

/**
 * Nodes
 */
.node footer { margin-top: 20px; }
.node.node-teaser footer { margin-top: 0; }

.node-type-page, .node-type-webform {
  #highlighted {
    margin: 12px 30px;
  }
  h1.title {
    border-bottom: 1px solid #000;
    font-size: 2.1em;
    margin-bottom: 0.5em;
    padding-bottom: 6px;
  }
  #sidebar_first-wrapper {
    margin-top: 3.5em;
  }
  #sidebar_second-wrapper {
    margin-top: 3.5em;
  }
  .block-menu-block {
    h2 { @include element-invisible; }
    li:hover, li.active {
      list-style-image: url("../images/li-star-active.png");

      a { color: $red; }
    }
  }
  p {
    @include serif;
  }
}
.node-type-webform #title-tabs-content-wrapper {
  // Add 12px of top padding to match page nodes (which have the #highlighted
  // area that effectively adds 12px of top spacing)
  padding-top: 12px;
}

// Node Permalink + Tags block
.node .header-metadata {
  background-color: #EBE7DD;
  border: solid 1px #666;
  font-size: 13px;
  margin: 0 5px 1em 5px;
  padding: 0.8em 1em;
  .permalink-label, .categories-label {
    font-weight: bold;
  }

  .categories-label { @include float-left; }
  .categories {
    // make subsequent lines of tags "indented" the same
    margin-left: 3em;
  }
}

.node-footnote {
  .header-metadata,
  .field-name-body {
    // Don't let the text to run too wide.
    max-width: 600px;
  }
}

.node-footnote.node-teaser {
  .header-top {
    // Make the title link cover the entire footnote (for teasers) so clicking
    // anywhere triggers the lightbox/links to the node page.
    a {
      position: absolute;
      top: 0; right: 0; bottom: 0; left: 0;
    }
  }
  .content .field-name-body { font-size: 13px; }
}
.node-footnote {
  @include border-radius(2px);
  background-color: $footnote_body_bg;
  border: 2px solid $dark_green;
  margin-bottom: 6px;
  padding: 1px;
  position: relative;

  .header-top {
    background-color: $footnote_header_bg;
    height: 23px;
    padding: 6px;
    margin-bottom: 1em;
    a:hover {
      text-decoration: none;
      h2.title { color: $red; }
    }
    h2.title, div.resource-icon {
      @include float-left;
      margin-right: 6px;
    }
    h2.title {
      @include border-radius(4px);
      @include float-left;
      @include sans-serif;
      background-color: white;
      color: black;
      font-size: 12px;
      font-weight: normal;
      line-height: 22px;
      height: 22px;
      padding: 0 10px;
    }
    .page-number {
      @include float-right;
      color: white;
      font-size: 12px;
      font-weight: bold;
      line-height: 23px;
    }
    .sharethis-widgets {
      // match h2 to vertically center with it
      height: 23px;
      line-height: 23px;
    }
  }
  .content, p.last-updated {
    clear: left;
    padding: 0 6px;
  }
  p.last-updated {
    color: $red;
    font-size: 12px;
    margin-bottom: 0;
  }
  footer .links {
    background-color: $footnote_header_bg;
    a {
      color: white;
      display: block;
      padding: 6px;
    }
    a:hover {
      background-color: $footnote_header_hover_bg;
    }
    margin: 0;
    position: absolute;
    bottom: 0;
    right: 0;
    li {
      margin: 0;
    }
  }
}

.node-visualization {
  header {
    h2 {
      @include float-left;
    }
    .sharethis-widgets {
      // match h2 to vertically center with it
      height: 40px;
      line-height: 40px;
      margin-bottom: 10px;
    }
  }
}

.sharethis-widgets {
  @include float-right;
  margin: 0 0 0 15px;
  // tighten up right spacing side a bit
  .st_email {
    .stButton { margin-right: 0; }
    .chicklets { padding-right: 0; }
  }
}

// add the .view selector so that we don't select footnotes being
// rendered within the lightbox for these styles
.node-footnote.node-teaser {
  .content {
    // constrain body to four lines of text showing
    line-height: 18px;
    height: 93px;
    overflow: hidden;
  }
  // Make footnote content area shorter since we have a 'last-updated' line
  // adding to our height
  &.with-last-updated .content {
    height: 72px;
  }
}

.page-footnotes.layout-fifty-fifty-left {
  #main {
    padding-top: 28px;
    padding-bottom: 28px;
  }
  #title-tabs-content-wrapper .main-content {
    padding-left: 18px;
  }
}

// Highlight (low-light?) the header when hovering over a footnote
.node-footnote header .header-top { @include transition(background-color, .1s); }
.node-footnote:hover {
  header .header-top {
    background-color: $footnote_header_hover_bg;
  }
}

/**
 * Search results / "Wide Open" layout pages
 */
body.layout-wide-open {
  #page-title, .main-content {
    padding-left: 10px;
    padding-right: 10px;
  }
  .search-result.alpha {
    margin-right: 0;
    article { margin-right: 10px; }
  }
  .search-result.omega {
    margin-left: 0;
    article { margin-left: 10px; }
  }
}

/* Search page */
.search-heading {
  @include float-left;
  font-size: 17px;
  font-weight: bold;
  line-height: 24px;
  margin-right: 1em;
}
.search-summary {
  @include float-left;
  border: 1px solid #999;
  background-color: #FFFAD6;
  padding: 2px 10px;
  font-size: 14px;
  line-height: 21px;
}
.search-keywords { font-weight: bold; }
.search-results { clear: left; }

/**
 * Gallery
 */
body.layout-gallery {
  hr.top, hr.bottom { display: none; }

  .main-content {
    margin-bottom: 20px;
  }

  // Remove the "paper" background
  #main-wrapper,
  #main-wrapper:before,
  #main-wrapper:after,
  #main:before {
    background: transparent none;
  }
  #sidebar_first {
    a { @include link-colors($light_blue, white); }

    background-color: #001B24;
    color: white;
    padding: 20px 22px 0 22px;
    .block {
      padding-bottom: 20px;
    }

    h1, h2, h3, h4, h5, h6 {
      color: $light_blue;
    }
    // Scale first three headings down to match h4
    h1, h2, h3 { font-size: 21px; line-height: 30px; margin-bottom: 4px; }
  }

  .view-gallery-collections,
  .view-visualizations {
    // the actual list items are bigger than they seem visually, due to the
    // background image having included drop-shadows.
    margin-right: -17px;
    margin-top: -3px;

    .gallery-items { margin-bottom: 0; }

    .no-results { color: white; }
  }

  .view-gallery-collections .gallery-items li,
  .view-visualizations .gallery-items li {
    @include float-left;
    height: 184px;
    width: 213px;
    margin: 0 9px 2px 0;
    position: relative;

    // Remove margin from last item of each row.
    &.views-row-3, &.views-row-6, &.views-row-9, &.views-row-12, &.views-row-15 { margin-right: 0; }

    .gallery-thumbnail {
      padding: 17px 21px 0;
      display: block;
    }
    // We abuse the title's wrapper div in order to display its background image
    // *above* the thumbnail--due to z-index stacking's interaction with back-
    // ground images, this must be done on a sibling element rather than a
    // parent of the image / image's stack.
    .gallery-title-wrapper {
      background: transparent url('../images/gallery-slide-thumbnail-overlay.png') no-repeat center center;
      position: absolute;
      top: 0; right: 0; bottom: 0; left: 0;
      z-index: 1;
    }
    a h4 {
      @include link-colors($body_bg, $red, $red);
      text-decoration: none;
      font-size: 14px;
      line-height: 18px;
      margin: 132px 0 0 0;
      padding: 0 21px;
      text-align: center;
      // limit to two lines displayed
      height: 36px;
      overflow: hidden;
    }
    a:hover h4 { color: $red; }
    a:hover { text-decoration: none; }
  }
}

/**
 * Pagers
 */
div.pager {
  clear: both;
  text-align: center;
}
ul.pager {
  @include border-radius(6px);
  @include inline-block;
  border: 2px solid #C9CACC;
  margin-bottom: 0;
  li {
    @include float-left;
    margin-bottom: 0;
    a, span {
      @include float-left;
      background-color: $border;
      font-size: 12px;
      height: 28px;
      line-height: 28px;
      padding: 0 8px;
    }
    a { @include transition(none); }
    a:hover {
      background-color: $footnote_header_bg;
      color: white;
      text-decoration: none;
    }
  }
  li.first a, li.first span { @include border-left-radius(5px); }
  li.last a, li.last span { @include border-right-radius(5px); }
  li.pager-current span {
    color: $red;
  }
}

/**
 * Search results
 */
.page-search ol li.search-result {
  margin-bottom: 0;
}

/**
 * Views
 */
.view-footnote-taxonomy ol,
.page-search ol {
  margin-left: 0;
  margin-bottom: 0;
}
.view-footnote-taxonomy ol {
  li {
    margin-bottom: 4px;
  }
  li a {
    display: block;
    padding: 10px 0 10px 16px;
    color: #333;
  }
  a.active {
    @include border-left-radius(6px);
    background-color: #F3EEDA;
    border: 1px solid $border;
    border-right: none;
    color: black;
  }
}
.view-footnote-taxonomy ol {
  @include no-bullets;
}

/**
 * Footer box
 */
#block-boxes-footer-box-left {
  text-align: center;
}
#block-boxes-footer-box-left .content a {
  display: block;
  width: 165px;
  height: 32px;
  background: url('../images/opensourcery-logo.png') no-repeat top center;
  text-indent: -9999px;
}
#block-boxes-footer-box-left .content a:hover {
  background-position: bottom center;
}
